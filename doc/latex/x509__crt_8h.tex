\hypertarget{x509__crt_8h}{}\section{prerequisites/c-\/libp2p/include/mbedtls/x509\+\_\+crt.h File Reference}
\label{x509__crt_8h}\index{prerequisites/c-\/libp2p/include/mbedtls/x509\+\_\+crt.\+h@{prerequisites/c-\/libp2p/include/mbedtls/x509\+\_\+crt.\+h}}


X.\+509 certificate parsing and writing.  


{\ttfamily \#include \char`\"{}config.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}x509.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}x509\+\_\+crl.\+h\char`\"{}}\newline
Include dependency graph for x509\+\_\+crt.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}}
\item 
struct \mbox{\hyperlink{structmbedtls__x509__crt__profile}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile}}
\item 
struct \mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{x509__crt_8h_a9da6bf87b583e0eea76bc3ca21a1f3dd}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+init}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Initialize a C\+RT writing context. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{x509__crt_8h_aa068b95987692787e169dc9d67677e57}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+version}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, int version)
\begin{DoxyCompactList}\small\item\em Set the verion for a Certificate Default\+: M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+3. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a32c8ac687c84d8066213297e6813c2f0}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+serial}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, const \mbox{\hyperlink{structmbedtls__mpi}{mbedtls\+\_\+mpi}} $\ast$serial)
\begin{DoxyCompactList}\small\item\em Set the serial number for a Certificate. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_ac7f9ece75e647023a0411a7bfa72b9f1}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+validity}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, const char $\ast$not\+\_\+before, const char $\ast$not\+\_\+after)
\begin{DoxyCompactList}\small\item\em Set the validity period for a Certificate Timestamps should be in string format for U\+TC timezone i.\+e. \char`\"{}\+Y\+Y\+Y\+Y\+M\+M\+D\+Dhhmmss\char`\"{} e.\+g. \char`\"{}20131231235959\char`\"{} for December 31st 2013 at 23\+:59\+:59. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a5378017315ad6ac4da70f07777259e19}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+name}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, const char $\ast$issuer\+\_\+name)
\begin{DoxyCompactList}\small\item\em Set the issuer name for a Certificate Issuer names should contain a comma-\/separated list of O\+ID types and values\+: e.\+g. \char`\"{}\+C=\+U\+K,\+O=\+A\+R\+M,\+C\+N=mbed T\+L\+S C\+A\char`\"{}. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a272798b488a8ad984c4db95142392ba6}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+name}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, const char $\ast$subject\+\_\+name)
\begin{DoxyCompactList}\small\item\em Set the subject name for a Certificate Subject names should contain a comma-\/separated list of O\+ID types and values\+: e.\+g. \char`\"{}\+C=\+U\+K,\+O=\+A\+R\+M,\+C\+N=mbed T\+L\+S Server 1\char`\"{}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{x509__crt_8h_a110c19b1d4379efa650a7e431276f9b0}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, \mbox{\hyperlink{structmbedtls__pk__context}{mbedtls\+\_\+pk\+\_\+context}} $\ast$key)
\begin{DoxyCompactList}\small\item\em Set the subject public key for the certificate. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{x509__crt_8h_a416f26146d68bb79aac90e8e48bbe7df}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, \mbox{\hyperlink{structmbedtls__pk__context}{mbedtls\+\_\+pk\+\_\+context}} $\ast$key)
\begin{DoxyCompactList}\small\item\em Set the issuer key used for signing the certificate. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{x509__crt_8h_abdb1cdce6c47b3e697258279bb0e8715}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+md\+\_\+alg}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, mbedtls\+\_\+md\+\_\+type\+\_\+t md\+\_\+alg)
\begin{DoxyCompactList}\small\item\em Set the MD algorithm to use for the signature (e.\+g. M\+B\+E\+D\+T\+L\+S\+\_\+\+M\+D\+\_\+\+S\+H\+A1) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a57804fd223bfd8601bdc76550385a50b}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+extension}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, const char $\ast$oid, size\+\_\+t oid\+\_\+len, int critical, const unsigned char $\ast$val, size\+\_\+t val\+\_\+len)
\begin{DoxyCompactList}\small\item\em Generic function to add to or replace an extension in the C\+RT. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_ae13aefe1e123dcbcefe1eccd7968b6d2}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+basic\+\_\+constraints}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, int is\+\_\+ca, int max\+\_\+pathlen)
\begin{DoxyCompactList}\small\item\em Set the basic\+Constraints extension for a C\+RT. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a09dd1d818f15b9655f5dbcd3d7c1ec0f}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key\+\_\+identifier}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Set the subject\+Key\+Identifier extension for a C\+RT Requires that \mbox{\hyperlink{x509__crt_8h_a110c19b1d4379efa650a7e431276f9b0}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key()}} has been called before. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a7e43c8a91bdd1f5c0b8f729ef602b624}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+authority\+\_\+key\+\_\+identifier}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Set the authority\+Key\+Identifier extension for a C\+RT Requires that \mbox{\hyperlink{x509__crt_8h_a416f26146d68bb79aac90e8e48bbe7df}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key()}} has been called before. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a5ce0db5d77fe07074601c585fe63089a}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+key\+\_\+usage}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, unsigned int key\+\_\+usage)
\begin{DoxyCompactList}\small\item\em Set the Key Usage Extension flags (e.\+g. M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+K\+U\+\_\+\+D\+I\+G\+I\+T\+A\+L\+\_\+\+S\+I\+G\+N\+A\+T\+U\+RE $\vert$ M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+K\+U\+\_\+\+K\+E\+Y\+\_\+\+C\+E\+R\+T\+\_\+\+S\+I\+GN) \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a62f8e6d643c142c87662655bcfc7c7a5}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+ns\+\_\+cert\+\_\+type}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, unsigned char ns\+\_\+cert\+\_\+type)
\begin{DoxyCompactList}\small\item\em Set the Netscape Cert Type flags (e.\+g. M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+N\+S\+\_\+\+C\+E\+R\+T\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+S\+L\+\_\+\+C\+L\+I\+E\+NT $\vert$ M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+N\+S\+\_\+\+C\+E\+R\+T\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+M\+A\+IL) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{x509__crt_8h_aacd2986253f977770c2353a54cf2e670}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+free}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Free the contents of a C\+RT write context. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_ada0550c8f7ce3e8b360f69c7475fa32f}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+der}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, unsigned char $\ast$buf, size\+\_\+t size, int($\ast$f\+\_\+rng)(void $\ast$, unsigned char $\ast$, size\+\_\+t), void $\ast$p\+\_\+rng)
\begin{DoxyCompactList}\small\item\em Write a built up certificate to a X509 D\+ER structure Note\+: data is written at the end of the buffer! Use the return value to determine where you should start using the buffer. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{x509__crt_8h_a2b1106722175cf04ef07313626728886}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+pem}} (\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$ctx, unsigned char $\ast$buf, size\+\_\+t size, int($\ast$f\+\_\+rng)(void $\ast$, unsigned char $\ast$, size\+\_\+t), void $\ast$p\+\_\+rng)
\begin{DoxyCompactList}\small\item\em Write a built up certificate to a X509 P\+EM string. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Structures and functions for parsing and writing X.509 certificates}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{group__x509__module_gaedcb73f1c615c266a348a0c62763c5de}{M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+I\+D\+\_\+\+F\+L\+AG}}(id)~( 1 $<$$<$ ( id -\/ 1 ) )
\item 
\#define {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+1}~0
\item 
\#define {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+2}~1
\item 
\#define {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+3}~2
\item 
\#define {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+R\+F\+C5280\+\_\+\+M\+A\+X\+\_\+\+S\+E\+R\+I\+A\+L\+\_\+\+L\+EN}~32
\item 
\#define {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+R\+F\+C5280\+\_\+\+U\+T\+C\+\_\+\+T\+I\+M\+E\+\_\+\+L\+EN}~15
\item 
\#define {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+M\+A\+X\+\_\+\+F\+I\+L\+E\+\_\+\+P\+A\+T\+H\+\_\+\+L\+EN}~512
\item 
typedef struct \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} \mbox{\hyperlink{group__x509__module_ga836544fec94d5bc02bc97aa87885b9d9}{mbedtls\+\_\+x509\+\_\+crt}}
\item 
typedef struct \mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} \mbox{\hyperlink{group__x509__module_gacc3115587f8d882a7a137c38d6939e07}{mbedtls\+\_\+x509write\+\_\+cert}}
\item 
const \mbox{\hyperlink{structmbedtls__x509__crt__profile}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile}} \mbox{\hyperlink{group__x509__module_ga9cd2de10ffeff0f339abcc1ba7e26fdf}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile\+\_\+default}}
\item 
const \mbox{\hyperlink{structmbedtls__x509__crt__profile}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile}} \mbox{\hyperlink{group__x509__module_ga8ab1f8a044fd25f76ecb4ba15c6d5bcd}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile\+\_\+next}}
\item 
const \mbox{\hyperlink{structmbedtls__x509__crt__profile}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile}} \mbox{\hyperlink{group__x509__module_gaf09067a39129236125e353a68ceb45d6}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile\+\_\+suiteb}}
\item 
int \mbox{\hyperlink{group__x509__module_ga003c2483a2691e025641fa9d68d4a96a}{mbedtls\+\_\+x509\+\_\+crt\+\_\+parse\+\_\+der}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$chain, const unsigned char $\ast$buf, size\+\_\+t buflen)
\begin{DoxyCompactList}\small\item\em Parse a single D\+ER formatted certificate and add it to the chained list. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_ga033567483649030f7f859db4f4cb7e14}{mbedtls\+\_\+x509\+\_\+crt\+\_\+parse}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$chain, const unsigned char $\ast$buf, size\+\_\+t buflen)
\begin{DoxyCompactList}\small\item\em Parse one or more certificates and add them to the chained list. Parses permissively. If some certificates can be parsed, the result is the number of failed certificates it encountered. If none complete correctly, the first error is returned. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_gad4da63133d3590aa311488497d4c38ec}{mbedtls\+\_\+x509\+\_\+crt\+\_\+parse\+\_\+file}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$chain, const char $\ast$path)
\begin{DoxyCompactList}\small\item\em Load one or more certificates and add them to the chained list. Parses permissively. If some certificates can be parsed, the result is the number of failed certificates it encountered. If none complete correctly, the first error is returned. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_ga571fc89b9f3217ab3dd67bd7af905066}{mbedtls\+\_\+x509\+\_\+crt\+\_\+parse\+\_\+path}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$chain, const char $\ast$path)
\begin{DoxyCompactList}\small\item\em Load one or more certificate files from a path and add them to the chained list. Parses permissively. If some certificates can be parsed, the result is the number of failed certificates it encountered. If none complete correctly, the first error is returned. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_gabaf30f2269fc3b6608b25871f9d09da6}{mbedtls\+\_\+x509\+\_\+crt\+\_\+info}} (char $\ast$buf, size\+\_\+t size, const char $\ast$prefix, const \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt)
\begin{DoxyCompactList}\small\item\em Returns an informational string about the certificate. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_gae88f1d8e6696eb2beeffe0a708219e6b}{mbedtls\+\_\+x509\+\_\+crt\+\_\+verify\+\_\+info}} (char $\ast$buf, size\+\_\+t size, const char $\ast$prefix, uint32\+\_\+t flags)
\begin{DoxyCompactList}\small\item\em Returns an informational string about the verification status of a certificate. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_ga98ed4504e4f832b735a230acf54fcde3}{mbedtls\+\_\+x509\+\_\+crt\+\_\+verify}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt, \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$trust\+\_\+ca, \mbox{\hyperlink{structmbedtls__x509__crl}{mbedtls\+\_\+x509\+\_\+crl}} $\ast$ca\+\_\+crl, const char $\ast$cn, uint32\+\_\+t $\ast$flags, int($\ast$f\+\_\+vrfy)(void $\ast$, \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$, int, uint32\+\_\+t $\ast$), void $\ast$p\+\_\+vrfy)
\begin{DoxyCompactList}\small\item\em Verify the certificate signature. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_gaf044a51e5b5bc854bf12aeeccb440e55}{mbedtls\+\_\+x509\+\_\+crt\+\_\+verify\+\_\+with\+\_\+profile}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt, \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$trust\+\_\+ca, \mbox{\hyperlink{structmbedtls__x509__crl}{mbedtls\+\_\+x509\+\_\+crl}} $\ast$ca\+\_\+crl, const \mbox{\hyperlink{structmbedtls__x509__crt__profile}{mbedtls\+\_\+x509\+\_\+crt\+\_\+profile}} $\ast$profile, const char $\ast$cn, uint32\+\_\+t $\ast$flags, int($\ast$f\+\_\+vrfy)(void $\ast$, \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$, int, uint32\+\_\+t $\ast$), void $\ast$p\+\_\+vrfy)
\begin{DoxyCompactList}\small\item\em Verify the certificate signature according to profile. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_ga0ab7857ffd82467207e718bb9f0131a2}{mbedtls\+\_\+x509\+\_\+crt\+\_\+check\+\_\+key\+\_\+usage}} (const \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt, unsigned int usage)
\begin{DoxyCompactList}\small\item\em Check usage of certificate against key\+Usage extension. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_gad21c0e75a3fdbeb1f65e4d339e479df3}{mbedtls\+\_\+x509\+\_\+crt\+\_\+check\+\_\+extended\+\_\+key\+\_\+usage}} (const \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt, const char $\ast$usage\+\_\+oid, size\+\_\+t usage\+\_\+len)
\begin{DoxyCompactList}\small\item\em Check usage of certificate against extented\+Jey\+Usage. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{group__x509__module_ga0dc256a70f90cb68002d53bafffab232}{mbedtls\+\_\+x509\+\_\+crt\+\_\+is\+\_\+revoked}} (const \mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt, const \mbox{\hyperlink{structmbedtls__x509__crl}{mbedtls\+\_\+x509\+\_\+crl}} $\ast$crl)
\begin{DoxyCompactList}\small\item\em Verify the certificate revocation status. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__x509__module_ga016dd06bc770e77b84005f305df20ed1}{mbedtls\+\_\+x509\+\_\+crt\+\_\+init}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt)
\begin{DoxyCompactList}\small\item\em Initialize a certificate (chain) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{group__x509__module_gab33c1e4e20bea7ce536119f54a113c6b}{mbedtls\+\_\+x509\+\_\+crt\+\_\+free}} (\mbox{\hyperlink{structmbedtls__x509__crt}{mbedtls\+\_\+x509\+\_\+crt}} $\ast$crt)
\begin{DoxyCompactList}\small\item\em Unallocate all certificate data. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
X.\+509 certificate parsing and writing. 

Copyright (C) 2006-\/2015, A\+RM Limited, All Rights Reserved S\+P\+D\+X-\/\+License-\/\+Identifier\+: Apache-\/2.\+0

Licensed under the Apache License, Version 2.\+0 (the \char`\"{}\+License\char`\"{}); you may not use this file except in compliance with the License. You may obtain a copy of the License at

\href{http://www.apache.org/licenses/LICENSE-2.0}{\tt http\+://www.\+apache.\+org/licenses/\+L\+I\+C\+E\+N\+S\+E-\/2.\+0}

Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \char`\"{}\+A\+S I\+S\char`\"{} B\+A\+S\+IS, W\+I\+T\+H\+O\+UT W\+A\+R\+R\+A\+N\+T\+I\+ES OR C\+O\+N\+D\+I\+T\+I\+O\+NS OF A\+NY K\+I\+ND, either express or implied. See the License for the specific language governing permissions and limitations under the License.

This file is part of mbed T\+LS (\href{https://tls.mbed.org}{\tt https\+://tls.\+mbed.\+org}) 

\subsection{Function Documentation}
\mbox{\Hypertarget{x509__crt_8h_ada0550c8f7ce3e8b360f69c7475fa32f}\label{x509__crt_8h_ada0550c8f7ce3e8b360f69c7475fa32f}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+der@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+der}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+der@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+der}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+der()}{mbedtls\_x509write\_crt\_der()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+der (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{unsigned char $\ast$}]{buf,  }\item[{size\+\_\+t}]{size,  }\item[{int($\ast$)(void $\ast$, unsigned char $\ast$, size\+\_\+t)}]{f\+\_\+rng,  }\item[{void $\ast$}]{p\+\_\+rng }\end{DoxyParamCaption})}



Write a built up certificate to a X509 D\+ER structure Note\+: data is written at the end of the buffer! Use the return value to determine where you should start using the buffer. 


\begin{DoxyParams}{Parameters}
{\em ctx} & certificate to write away \\
\hline
{\em buf} & buffer to write to \\
\hline
{\em size} & size of the buffer \\
\hline
{\em f\+\_\+rng} & R\+NG function (for signature, see note) \\
\hline
{\em p\+\_\+rng} & R\+NG parameter\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
length of data written if successful, or a specific error code
\end{DoxyReturn}
\begin{DoxyNote}{Note}
f\+\_\+rng may be N\+U\+LL if R\+SA is used for signature and the signature is made offline (otherwise f\+\_\+rng is desirable for countermeasures against timing attacks). E\+C\+D\+SA signatures always require a non-\/\+N\+U\+LL f\+\_\+rng. 
\end{DoxyNote}
\mbox{\Hypertarget{x509__crt_8h_aacd2986253f977770c2353a54cf2e670}\label{x509__crt_8h_aacd2986253f977770c2353a54cf2e670}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+free@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+free}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+free@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+free}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+free()}{mbedtls\_x509write\_crt\_free()}}
{\footnotesize\ttfamily void mbedtls\+\_\+x509write\+\_\+crt\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx }\end{DoxyParamCaption})}



Free the contents of a C\+RT write context. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to free \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{x509__crt_8h_a9da6bf87b583e0eea76bc3ca21a1f3dd}\label{x509__crt_8h_a9da6bf87b583e0eea76bc3ca21a1f3dd}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+init@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+init}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+init@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+init}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+init()}{mbedtls\_x509write\_crt\_init()}}
{\footnotesize\ttfamily void mbedtls\+\_\+x509write\+\_\+crt\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx }\end{DoxyParamCaption})}



Initialize a C\+RT writing context. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to initialize \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{x509__crt_8h_a2b1106722175cf04ef07313626728886}\label{x509__crt_8h_a2b1106722175cf04ef07313626728886}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+pem@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+pem}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+pem@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+pem}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+pem()}{mbedtls\_x509write\_crt\_pem()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+pem (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{unsigned char $\ast$}]{buf,  }\item[{size\+\_\+t}]{size,  }\item[{int($\ast$)(void $\ast$, unsigned char $\ast$, size\+\_\+t)}]{f\+\_\+rng,  }\item[{void $\ast$}]{p\+\_\+rng }\end{DoxyParamCaption})}



Write a built up certificate to a X509 P\+EM string. 


\begin{DoxyParams}{Parameters}
{\em ctx} & certificate to write away \\
\hline
{\em buf} & buffer to write to \\
\hline
{\em size} & size of the buffer \\
\hline
{\em f\+\_\+rng} & R\+NG function (for signature, see note) \\
\hline
{\em p\+\_\+rng} & R\+NG parameter\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, or a specific error code
\end{DoxyReturn}
\begin{DoxyNote}{Note}
f\+\_\+rng may be N\+U\+LL if R\+SA is used for signature and the signature is made offline (otherwise f\+\_\+rng is desirable for countermeasures against timing attacks). E\+C\+D\+SA signatures always require a non-\/\+N\+U\+LL f\+\_\+rng. 
\end{DoxyNote}
\mbox{\Hypertarget{x509__crt_8h_a7e43c8a91bdd1f5c0b8f729ef602b624}\label{x509__crt_8h_a7e43c8a91bdd1f5c0b8f729ef602b624}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+authority\+\_\+key\+\_\+identifier@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+authority\+\_\+key\+\_\+identifier}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+authority\+\_\+key\+\_\+identifier@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+authority\+\_\+key\+\_\+identifier}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+authority\+\_\+key\+\_\+identifier()}{mbedtls\_x509write\_crt\_set\_authority\_key\_identifier()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+authority\+\_\+key\+\_\+identifier (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx }\end{DoxyParamCaption})}



Set the authority\+Key\+Identifier extension for a C\+RT Requires that \mbox{\hyperlink{x509__crt_8h_a416f26146d68bb79aac90e8e48bbe7df}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key()}} has been called before. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, or a M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+X509\+\_\+\+A\+L\+L\+O\+C\+\_\+\+F\+A\+I\+L\+ED 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_ae13aefe1e123dcbcefe1eccd7968b6d2}\label{x509__crt_8h_ae13aefe1e123dcbcefe1eccd7968b6d2}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+basic\+\_\+constraints@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+basic\+\_\+constraints}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+basic\+\_\+constraints@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+basic\+\_\+constraints}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+basic\+\_\+constraints()}{mbedtls\_x509write\_crt\_set\_basic\_constraints()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+basic\+\_\+constraints (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{int}]{is\+\_\+ca,  }\item[{int}]{max\+\_\+pathlen }\end{DoxyParamCaption})}



Set the basic\+Constraints extension for a C\+RT. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em is\+\_\+ca} & is this a CA certificate \\
\hline
{\em max\+\_\+pathlen} & maximum length of certificate chains below this certificate (only for CA certificates, -\/1 is inlimited)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, or a M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+X509\+\_\+\+A\+L\+L\+O\+C\+\_\+\+F\+A\+I\+L\+ED 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_a57804fd223bfd8601bdc76550385a50b}\label{x509__crt_8h_a57804fd223bfd8601bdc76550385a50b}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+extension@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+extension}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+extension@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+extension}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+extension()}{mbedtls\_x509write\_crt\_set\_extension()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+extension (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{const char $\ast$}]{oid,  }\item[{size\+\_\+t}]{oid\+\_\+len,  }\item[{int}]{critical,  }\item[{const unsigned char $\ast$}]{val,  }\item[{size\+\_\+t}]{val\+\_\+len }\end{DoxyParamCaption})}



Generic function to add to or replace an extension in the C\+RT. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em oid} & O\+ID of the extension \\
\hline
{\em oid\+\_\+len} & length of the O\+ID \\
\hline
{\em critical} & if the extension is critical (per the R\+FC\textquotesingle{}s definition) \\
\hline
{\em val} & value of the extension O\+C\+T\+ET S\+T\+R\+I\+NG \\
\hline
{\em val\+\_\+len} & length of the value data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, or a M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+X509\+\_\+\+A\+L\+L\+O\+C\+\_\+\+F\+A\+I\+L\+ED 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_a416f26146d68bb79aac90e8e48bbe7df}\label{x509__crt_8h_a416f26146d68bb79aac90e8e48bbe7df}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key()}{mbedtls\_x509write\_crt\_set\_issuer\_key()}}
{\footnotesize\ttfamily void mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{\mbox{\hyperlink{structmbedtls__pk__context}{mbedtls\+\_\+pk\+\_\+context}} $\ast$}]{key }\end{DoxyParamCaption})}



Set the issuer key used for signing the certificate. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em key} & private key to sign with \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{x509__crt_8h_a5378017315ad6ac4da70f07777259e19}\label{x509__crt_8h_a5378017315ad6ac4da70f07777259e19}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+name@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+name}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+name@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+name}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+name()}{mbedtls\_x509write\_crt\_set\_issuer\_name()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+issuer\+\_\+name (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{const char $\ast$}]{issuer\+\_\+name }\end{DoxyParamCaption})}



Set the issuer name for a Certificate Issuer names should contain a comma-\/separated list of O\+ID types and values\+: e.\+g. \char`\"{}\+C=\+U\+K,\+O=\+A\+R\+M,\+C\+N=mbed T\+L\+S C\+A\char`\"{}. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em issuer\+\_\+name} & issuer name to set\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if issuer name was parsed successfully, or a specific error code 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_a5ce0db5d77fe07074601c585fe63089a}\label{x509__crt_8h_a5ce0db5d77fe07074601c585fe63089a}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+key\+\_\+usage@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+key\+\_\+usage}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+key\+\_\+usage@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+key\+\_\+usage}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+key\+\_\+usage()}{mbedtls\_x509write\_crt\_set\_key\_usage()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+key\+\_\+usage (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{unsigned int}]{key\+\_\+usage }\end{DoxyParamCaption})}



Set the Key Usage Extension flags (e.\+g. M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+K\+U\+\_\+\+D\+I\+G\+I\+T\+A\+L\+\_\+\+S\+I\+G\+N\+A\+T\+U\+RE $\vert$ M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+K\+U\+\_\+\+K\+E\+Y\+\_\+\+C\+E\+R\+T\+\_\+\+S\+I\+GN) 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em key\+\_\+usage} & key usage flags to set\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, or M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+X509\+\_\+\+A\+L\+L\+O\+C\+\_\+\+F\+A\+I\+L\+ED 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_abdb1cdce6c47b3e697258279bb0e8715}\label{x509__crt_8h_abdb1cdce6c47b3e697258279bb0e8715}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+md\+\_\+alg@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+md\+\_\+alg}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+md\+\_\+alg@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+md\+\_\+alg}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+md\+\_\+alg()}{mbedtls\_x509write\_crt\_set\_md\_alg()}}
{\footnotesize\ttfamily void mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+md\+\_\+alg (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{mbedtls\+\_\+md\+\_\+type\+\_\+t}]{md\+\_\+alg }\end{DoxyParamCaption})}



Set the MD algorithm to use for the signature (e.\+g. M\+B\+E\+D\+T\+L\+S\+\_\+\+M\+D\+\_\+\+S\+H\+A1) 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em md\+\_\+alg} & MD algorithm to use \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{x509__crt_8h_a62f8e6d643c142c87662655bcfc7c7a5}\label{x509__crt_8h_a62f8e6d643c142c87662655bcfc7c7a5}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+ns\+\_\+cert\+\_\+type@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+ns\+\_\+cert\+\_\+type}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+ns\+\_\+cert\+\_\+type@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+ns\+\_\+cert\+\_\+type}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+ns\+\_\+cert\+\_\+type()}{mbedtls\_x509write\_crt\_set\_ns\_cert\_type()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+ns\+\_\+cert\+\_\+type (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{unsigned char}]{ns\+\_\+cert\+\_\+type }\end{DoxyParamCaption})}



Set the Netscape Cert Type flags (e.\+g. M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+N\+S\+\_\+\+C\+E\+R\+T\+\_\+\+T\+Y\+P\+E\+\_\+\+S\+S\+L\+\_\+\+C\+L\+I\+E\+NT $\vert$ M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+N\+S\+\_\+\+C\+E\+R\+T\+\_\+\+T\+Y\+P\+E\+\_\+\+E\+M\+A\+IL) 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em ns\+\_\+cert\+\_\+type} & Netscape Cert Type flags to set\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, or M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+X509\+\_\+\+A\+L\+L\+O\+C\+\_\+\+F\+A\+I\+L\+ED 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_a32c8ac687c84d8066213297e6813c2f0}\label{x509__crt_8h_a32c8ac687c84d8066213297e6813c2f0}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+serial@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+serial}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+serial@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+serial}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+serial()}{mbedtls\_x509write\_crt\_set\_serial()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+serial (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{const \mbox{\hyperlink{structmbedtls__mpi}{mbedtls\+\_\+mpi}} $\ast$}]{serial }\end{DoxyParamCaption})}



Set the serial number for a Certificate. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em serial} & serial number to set\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_a110c19b1d4379efa650a7e431276f9b0}\label{x509__crt_8h_a110c19b1d4379efa650a7e431276f9b0}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key()}{mbedtls\_x509write\_crt\_set\_subject\_key()}}
{\footnotesize\ttfamily void mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{\mbox{\hyperlink{structmbedtls__pk__context}{mbedtls\+\_\+pk\+\_\+context}} $\ast$}]{key }\end{DoxyParamCaption})}



Set the subject public key for the certificate. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em key} & public key to include \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{x509__crt_8h_a09dd1d818f15b9655f5dbcd3d7c1ec0f}\label{x509__crt_8h_a09dd1d818f15b9655f5dbcd3d7c1ec0f}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key\+\_\+identifier@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key\+\_\+identifier}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key\+\_\+identifier@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key\+\_\+identifier}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key\+\_\+identifier()}{mbedtls\_x509write\_crt\_set\_subject\_key\_identifier()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key\+\_\+identifier (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx }\end{DoxyParamCaption})}



Set the subject\+Key\+Identifier extension for a C\+RT Requires that \mbox{\hyperlink{x509__crt_8h_a110c19b1d4379efa650a7e431276f9b0}{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+key()}} has been called before. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful, or a M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+X509\+\_\+\+A\+L\+L\+O\+C\+\_\+\+F\+A\+I\+L\+ED 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_a272798b488a8ad984c4db95142392ba6}\label{x509__crt_8h_a272798b488a8ad984c4db95142392ba6}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+name@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+name}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+name@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+name}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+name()}{mbedtls\_x509write\_crt\_set\_subject\_name()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+subject\+\_\+name (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{const char $\ast$}]{subject\+\_\+name }\end{DoxyParamCaption})}



Set the subject name for a Certificate Subject names should contain a comma-\/separated list of O\+ID types and values\+: e.\+g. \char`\"{}\+C=\+U\+K,\+O=\+A\+R\+M,\+C\+N=mbed T\+L\+S Server 1\char`\"{}. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em subject\+\_\+name} & subject name to set\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if subject name was parsed successfully, or a specific error code 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_ac7f9ece75e647023a0411a7bfa72b9f1}\label{x509__crt_8h_ac7f9ece75e647023a0411a7bfa72b9f1}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+validity@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+validity}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+validity@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+validity}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+validity()}{mbedtls\_x509write\_crt\_set\_validity()}}
{\footnotesize\ttfamily int mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+validity (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{const char $\ast$}]{not\+\_\+before,  }\item[{const char $\ast$}]{not\+\_\+after }\end{DoxyParamCaption})}



Set the validity period for a Certificate Timestamps should be in string format for U\+TC timezone i.\+e. \char`\"{}\+Y\+Y\+Y\+Y\+M\+M\+D\+Dhhmmss\char`\"{} e.\+g. \char`\"{}20131231235959\char`\"{} for December 31st 2013 at 23\+:59\+:59. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em not\+\_\+before} & not\+\_\+before timestamp \\
\hline
{\em not\+\_\+after} & not\+\_\+after timestamp\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if timestamp was parsed successfully, or a specific error code 
\end{DoxyReturn}
\mbox{\Hypertarget{x509__crt_8h_aa068b95987692787e169dc9d67677e57}\label{x509__crt_8h_aa068b95987692787e169dc9d67677e57}} 
\index{x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}!mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+version@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+version}}
\index{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+version@{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+version}!x509\+\_\+crt.\+h@{x509\+\_\+crt.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+version()}{mbedtls\_x509write\_crt\_set\_version()}}
{\footnotesize\ttfamily void mbedtls\+\_\+x509write\+\_\+crt\+\_\+set\+\_\+version (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmbedtls__x509write__cert}{mbedtls\+\_\+x509write\+\_\+cert}} $\ast$}]{ctx,  }\item[{int}]{version }\end{DoxyParamCaption})}



Set the verion for a Certificate Default\+: M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+3. 


\begin{DoxyParams}{Parameters}
{\em ctx} & C\+RT context to use \\
\hline
{\em version} & version to set (M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+1, M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+2 or M\+B\+E\+D\+T\+L\+S\+\_\+\+X509\+\_\+\+C\+R\+T\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+3) \\
\hline
\end{DoxyParams}
