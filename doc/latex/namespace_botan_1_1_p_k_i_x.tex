\hypertarget{namespace_botan_1_1_p_k_i_x}{}\section{Botan\+:\+:P\+K\+IX Namespace Reference}
\label{namespace_botan_1_1_p_k_i_x}\index{Botan\+::\+P\+K\+IX@{Botan\+::\+P\+K\+IX}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespace_botan_ae1e907dc90937bdda30f65216e68ff2b}{Certificate\+\_\+\+Status\+\_\+\+Code}} \mbox{\hyperlink{namespace_botan_1_1_p_k_i_x_a0088a8298180d3f9cfb6a8f1c0cd3253}{build\+\_\+all\+\_\+certificate\+\_\+paths}} (std\+::vector$<$ std\+::vector$<$ std\+::shared\+\_\+ptr$<$ const X509\+\_\+\+Certificate $>$$>$$>$ \&cert\+\_\+paths, const std\+::vector$<$ Certificate\+\_\+\+Store $\ast$$>$ \&trusted\+\_\+certstores, const std\+::shared\+\_\+ptr$<$ const X509\+\_\+\+Certificate $>$ \&end\+\_\+entity, const std\+::vector$<$ std\+::shared\+\_\+ptr$<$ const X509\+\_\+\+Certificate $>$$>$ \&end\+\_\+entity\+\_\+extra)
\item 
\mbox{\hyperlink{namespace_botan_ae1e907dc90937bdda30f65216e68ff2b}{Certificate\+\_\+\+Status\+\_\+\+Code}} B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI(2, 0) build\+\_\+certificate\+\_\+path(std \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI(2, 0) check\+\_\+chain(const std \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI(2, 0) check\+\_\+ocsp(const std \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI(2, 0) check\+\_\+crl(const std \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI(2, 0) check\+\_\+crl(const std \mbox{\hyperlink{namespace_botan_ae1e907dc90937bdda30f65216e68ff2b}{Certificate\+\_\+\+Status\+\_\+\+Code}} \mbox{\hyperlink{namespace_botan_1_1_p_k_i_x_aa89b961cb12e496c942682134924ad40}{B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI}} (2, 0) overall\+\_\+status(const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} \&cert\+\_\+status)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{namespace_botan_1_1_p_k_i_x_a44fb410b4f57b3cb8cbf7cfb31ce9a24}\label{namespace_botan_1_1_p_k_i_x_a44fb410b4f57b3cb8cbf7cfb31ce9a24}} 
void const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} \& {\bfseries crl\+\_\+status}
\item 
\mbox{\Hypertarget{namespace_botan_1_1_p_k_i_x_abd1a7e92082beda13ef61dd3bc2cb220}\label{namespace_botan_1_1_p_k_i_x_abd1a7e92082beda13ef61dd3bc2cb220}} 
void const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} \& {\bfseries ocsp\+\_\+status}
\item 
\mbox{\Hypertarget{namespace_botan_1_1_p_k_i_x_ab7a891ad4c6e2a83e1cdd7bf4be0d532}\label{namespace_botan_1_1_p_k_i_x_ab7a891ad4c6e2a83e1cdd7bf4be0d532}} 
void const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} bool {\bfseries require\+\_\+rev\+\_\+on\+\_\+end\+\_\+entity}
\item 
\mbox{\Hypertarget{namespace_botan_1_1_p_k_i_x_a7693a8b765b069367dd8f2c8cbc4b2d0}\label{namespace_botan_1_1_p_k_i_x_a7693a8b765b069367dd8f2c8cbc4b2d0}} 
void const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} const \mbox{\hyperlink{namespace_botan_a013252aabcb201e0d27b60b1e690886b}{Certificate\+Path\+Status\+Codes}} bool bool {\bfseries require\+\_\+rev\+\_\+on\+\_\+intermediates}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
namespace \mbox{\hyperlink{namespace_botan_1_1_p_k_i_x}{P\+K\+IX}} holds the building blocks that are called by x509\+\_\+path\+\_\+validate. This allows custom validation logic to be written by applications and makes for easier testing, but unless you\textquotesingle{}re positive you know what you\textquotesingle{}re doing you probably want to just call x509\+\_\+path\+\_\+validate instead. 

\subsection{Function Documentation}
\mbox{\Hypertarget{namespace_botan_1_1_p_k_i_x_aa89b961cb12e496c942682134924ad40}\label{namespace_botan_1_1_p_k_i_x_aa89b961cb12e496c942682134924ad40}} 
\index{Botan\+::\+P\+K\+IX@{Botan\+::\+P\+K\+IX}!B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI@{B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI}}
\index{B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI@{B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI}!Botan\+::\+P\+K\+IX@{Botan\+::\+P\+K\+IX}}
\subsubsection{\texorpdfstring{B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+P\+I()}{BOTAN\_PUBLIC\_API()}}
{\footnotesize\ttfamily void Botan\+::\+P\+K\+I\+X\+::\+B\+O\+T\+A\+N\+\_\+\+P\+U\+B\+L\+I\+C\+\_\+\+A\+PI (\begin{DoxyParamCaption}\item[{2}]{,  }\item[{0}]{ }\end{DoxyParamCaption}) const \&}

Build certificate path 
\begin{DoxyParams}{Parameters}
{\em cert\+\_\+path\+\_\+out} & output parameter, cert\+\_\+path will be appended to this vector \\
\hline
{\em trusted\+\_\+certstores} & list of certificate stores that contain trusted certificates \\
\hline
{\em end\+\_\+entity} & the cert to be validated \\
\hline
{\em end\+\_\+entity\+\_\+extra} & optional list of additional untrusted certs for path building \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
result of the path building operation (OK or error) Check the certificate chain, but not any revocation data
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em cert\+\_\+path} & path built by build\+\_\+certificate\+\_\+path with OK result \\
\hline
{\em ref\+\_\+time} & whatever time you want to perform the validation against (normally current system clock) \\
\hline
{\em hostname} & the hostname \\
\hline
{\em usage} & end entity usage checks \\
\hline
{\em min\+\_\+signature\+\_\+algo\+\_\+strength} & 80 or 110 typically Note 80 allows 1024 bit R\+SA and S\+H\+A-\/1. 110 allows 2048 bit R\+SA and S\+H\+A-\/2. Using 128 requires E\+CC (P-\/256) or $\sim$3000 bit R\+SA keys. \\
\hline
{\em trusted\+\_\+hashes} & set of trusted hash functions, empty means accept any hash we have an O\+ID for \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
vector of results on per certificate in the path, each containing a set of results. If all codes in the set are $<$ Certificate\+\_\+\+Status\+\_\+\+Code\+::\+F\+I\+R\+S\+T\+\_\+\+E\+R\+R\+O\+R\+\_\+\+S\+T\+A\+T\+US, then the result for that certificate is successful. If all results are Check O\+C\+SP responses for revocation information 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em cert\+\_\+path} & path already validated by check\+\_\+chain \\
\hline
{\em ocsp\+\_\+responses} & the O\+C\+SP responses to consider \\
\hline
{\em certstores} & trusted roots \\
\hline
{\em ref\+\_\+time} & whatever time you want to perform the validation against (normally current system clock) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
revocation status Check C\+R\+Ls for revocation information 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em cert\+\_\+path} & path already validated by check\+\_\+chain \\
\hline
{\em crls} & the list of C\+R\+Ls to check, it is assumed that crls\mbox{[}i\mbox{]} (if not null) is the associated C\+RL for the subject in cert\+\_\+path\mbox{[}i\mbox{]}. \\
\hline
{\em ref\+\_\+time} & whatever time you want to perform the validation against (normally current system clock) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
revocation status Check C\+R\+Ls for revocation information 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em cert\+\_\+path} & path already validated by check\+\_\+chain \\
\hline
{\em certstores} & a list of certificate stores to query for the C\+RL \\
\hline
{\em ref\+\_\+time} & whatever time you want to perform the validation against (normally current system clock) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
revocation status Find overall status (OK, error) of a validation 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em cert\+\_\+status} & result of merge\+\_\+revocation\+\_\+status or check\+\_\+chain\\
\hline
\end{DoxyParams}
Merge the results from C\+RL and/or O\+C\+SP checks into chain\+\_\+status 
\begin{DoxyParams}{Parameters}
{\em chain\+\_\+status} & the certificate status \\
\hline
{\em crl\+\_\+status} & results from check\+\_\+crl \\
\hline
{\em ocsp\+\_\+status} & results from check\+\_\+ocsp \\
\hline
{\em require\+\_\+rev\+\_\+on\+\_\+end\+\_\+entity} & require valid C\+RL or O\+C\+SP on end-\/entity cert \\
\hline
{\em require\+\_\+rev\+\_\+on\+\_\+intermediates} & require valid C\+RL or O\+C\+SP on all intermediate certificates \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespace_botan_1_1_p_k_i_x_a0088a8298180d3f9cfb6a8f1c0cd3253}\label{namespace_botan_1_1_p_k_i_x_a0088a8298180d3f9cfb6a8f1c0cd3253}} 
\index{Botan\+::\+P\+K\+IX@{Botan\+::\+P\+K\+IX}!build\+\_\+all\+\_\+certificate\+\_\+paths@{build\+\_\+all\+\_\+certificate\+\_\+paths}}
\index{build\+\_\+all\+\_\+certificate\+\_\+paths@{build\+\_\+all\+\_\+certificate\+\_\+paths}!Botan\+::\+P\+K\+IX@{Botan\+::\+P\+K\+IX}}
\subsubsection{\texorpdfstring{build\+\_\+all\+\_\+certificate\+\_\+paths()}{build\_all\_certificate\_paths()}}
{\footnotesize\ttfamily \mbox{\hyperlink{namespace_botan_ae1e907dc90937bdda30f65216e68ff2b}{Certificate\+\_\+\+Status\+\_\+\+Code}} Botan\+::\+P\+K\+I\+X\+::build\+\_\+all\+\_\+certificate\+\_\+paths (\begin{DoxyParamCaption}\item[{std\+::vector$<$ std\+::vector$<$ std\+::shared\+\_\+ptr$<$ const X509\+\_\+\+Certificate $>$$>$$>$ \&}]{cert\+\_\+paths\+\_\+out,  }\item[{const std\+::vector$<$ Certificate\+\_\+\+Store $\ast$$>$ \&}]{trusted\+\_\+certstores,  }\item[{const std\+::shared\+\_\+ptr$<$ const X509\+\_\+\+Certificate $>$ \&}]{end\+\_\+entity,  }\item[{const std\+::vector$<$ std\+::shared\+\_\+ptr$<$ const X509\+\_\+\+Certificate $>$$>$ \&}]{end\+\_\+entity\+\_\+extra }\end{DoxyParamCaption})}

Build all possible certificate paths from the end certificate to self-\/signed trusted roots.

All potentially valid paths are put into the cert\+\_\+paths vector. If no potentially valid paths are found, one of the encountered errors is returned arbitrarily.

todo add a path building function that returns detailed information on errors encountered while building the potentially numerous path candidates.

Basically, a D\+FS is performed starting from the end certificate. A stack (vector) serves to control the D\+FS. At the beginning of each iteration, a pair is popped from the stack that contains (1) the next certificate to add to the path (2) a bool that indicates if the certificate is part of a trusted certstore. Ideally, we follow the unique issuer of the current certificate until a trusted root is reached. However, the issuer DN + authority key id need not be unique among the certificates used for building the path. In such a case, we consider all the matching issuers by pushing $<$Issuer\+Cert, trusted?$>$ on the stack for each of them. 

Definition at line 613 of file x509path.\+cpp.

