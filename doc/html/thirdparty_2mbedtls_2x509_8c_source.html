<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>even-network: prerequisites/c-libp2p/thirdparty/mbedtls/x509.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="2018-12-27 at 10-36-23.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">even-network
   </div>
   <div id="projectbrief">EVEN Network â€” is an open cross-chain platform with EVEN cryptocurrency that allows users to interact with more than one blockchain at a time.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0dc8670ce003965ad6657bffb381fe41.html">prerequisites</a></li><li class="navelem"><a class="el" href="dir_d3dc2089ddf61d8be1e3bff92bba4632.html">c-libp2p</a></li><li class="navelem"><a class="el" href="dir_3cc4b7e6e8cb3f4ecac6acb546e524a7.html">thirdparty</a></li><li class="navelem"><a class="el" href="dir_e89f8300491e216f523c46c748afd590.html">mbedtls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">x509.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  X.509 common functions for parsing and verification</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  not use this file except in compliance with the License.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  You may obtain a copy of the License at</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  limitations under the License.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *  This file is part of mbed TLS (https://tls.mbed.org)</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *  The ITU-T X.509 standard defines a certificate format for PKI.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *  http://www.ietf.org/rfc/rfc5280.txt (Certificates and CRLs)</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *  http://www.ietf.org/rfc/rfc3279.txt (Alg IDs for CRLs)</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *  http://www.ietf.org/rfc/rfc2986.txt (CSRs, aka PKCS#10)</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *  http://www.itu.int/ITU-T/studygroups/com17/languages/X.680-0207.pdf</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *  http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#if !defined(MBEDTLS_CONFIG_FILE)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;mbedtls/config.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include MBEDTLS_CONFIG_FILE</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_USE_C)</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;mbedtls/x509.h&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="asn1_8h.html">mbedtls/asn1.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oid_8h.html">mbedtls/oid.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PEM_PARSE_C)</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;mbedtls/pem.h&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PLATFORM_C)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="platform_8h.html">mbedtls/platform.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#define mbedtls_free      free</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#define mbedtls_calloc    calloc</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#define mbedtls_printf    printf</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#define mbedtls_snprintf  snprintf</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="platform__time_8h.html">mbedtls/platform_time.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#if defined(_WIN32) &amp;&amp; !defined(EFIX64) &amp;&amp; !defined(EFI32)</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &lt;windows.h&gt;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_FS_IO)</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#if !defined(_WIN32)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &lt;dirent.h&gt;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#define CHECK(code) if( ( ret = code ) != 0 ){ return( ret ); }</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#define CHECK_RANGE(min, max, val) if( val &lt; min || val &gt; max ){ return( ret ); }</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> *  CertificateSerialNumber  ::=  INTEGER</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_serial( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end,</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                     <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *serial )</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span>( ( end - *p ) &lt; 1 )</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8124a68edabf35ed9323880584128f16">MBEDTLS_ERR_X509_INVALID_SERIAL</a> +</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <a class="code" href="group__asn1__module.html#ga284c12cf03a4ffeee89a63750f00dfdd">MBEDTLS_ERR_ASN1_OUT_OF_DATA</a> );</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span>( **p != ( MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_PRIMITIVE | 2 ) &amp;&amp;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        **p !=   MBEDTLS_ASN1_INTEGER )</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8124a68edabf35ed9323880584128f16">MBEDTLS_ERR_X509_INVALID_SERIAL</a> +</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> );</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">tag</a> = *(*p)++;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ad45c1d0ed3694fe903342cb32647bfb1">mbedtls_asn1_get_len</a>( p, end, &amp;serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> ) ) != 0 )</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8124a68edabf35ed9323880584128f16">MBEDTLS_ERR_X509_INVALID_SERIAL</a> + ret );</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> = *p;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    *p += serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">/* Get an algorithm identifier without parameters (eg for signatures)</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> *  AlgorithmIdentifier  ::=  SEQUENCE  {</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> *       algorithm               OBJECT IDENTIFIER,</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> *       parameters              ANY DEFINED BY algorithm OPTIONAL  }</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_alg_null( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                       <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *alg )</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#adad023ecf92a50d47eaf206705efdb0e">mbedtls_asn1_get_alg_null</a>( p, end, alg ) ) != 0 )</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> * Parse an algorithm identifier with (optional) paramaters</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_alg( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end,</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                  <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *alg, <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *params )</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#add253579640ea717f368d9a0f6085be0">mbedtls_asn1_get_alg</a>( p, end, alg, params ) ) != 0 )</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_RSASSA_PSS_SUPPORT)</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> * HashAlgorithm ::= AlgorithmIdentifier</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> * AlgorithmIdentifier  ::=  SEQUENCE  {</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> *      algorithm               OBJECT IDENTIFIER,</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> *      parameters              ANY DEFINED BY algorithm OPTIONAL  }</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> * For HashAlgorithm, parameters MUST be NULL or absent.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> x509_get_hash_alg( <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *alg, mbedtls_md_type_t *md_alg )</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> md_oid;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">/* Make sure we got a SEQUENCE and setup bounds */</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span>( alg-&gt;<a class="code" href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">tag</a> != ( MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) )</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) alg-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    end = p + alg-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span>( p &gt;= end )</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <a class="code" href="group__asn1__module.html#ga284c12cf03a4ffeee89a63750f00dfdd">MBEDTLS_ERR_ASN1_OUT_OF_DATA</a> );</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">/* Parse md_oid */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    md_oid.<a class="code" href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">tag</a> = *p;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( &amp;p, end, &amp;md_oid.<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>, MBEDTLS_ASN1_OID ) ) != 0 )</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    md_oid.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> = p;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    p += md_oid.<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">/* Get md_alg from md_oid */</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="oid_8h.html#ad17c5466d99de2ea8a9c581ecdfbded1">mbedtls_oid_get_md_alg</a>( &amp;md_oid, md_alg ) ) != 0 )</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">/* Make sure params is absent of NULL */</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span>( p == end )</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( &amp;p, end, &amp;len, MBEDTLS_ASN1_NULL ) ) != 0 || len != 0 )</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span>( p != end )</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <a class="code" href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a> );</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> *    RSASSA-PSS-params  ::=  SEQUENCE  {</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> *       hashAlgorithm     [0] HashAlgorithm DEFAULT sha1Identifier,</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> *       maskGenAlgorithm  [1] MaskGenAlgorithm DEFAULT mgf1SHA1Identifier,</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> *       saltLength        [2] INTEGER DEFAULT 20,</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> *       trailerField      [3] INTEGER DEFAULT 1  }</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> *    -- Note that the tags in this Sequence are explicit.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> * RFC 4055 (which defines use of RSASSA-PSS in PKIX) states that the value</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * of trailerField MUST be 1, and PKCS#1 v2.2 doesn&#39;t even define any other</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> * option. Enfore this at parsing time.</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_rsassa_pss_params( <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *params,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                                mbedtls_md_type_t *md_alg, mbedtls_md_type_t *mgf_md,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                <span class="keywordtype">int</span> *salt_len )</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end, *end2;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> alg_id, alg_params;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">/* First set everything to defaults */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    *md_alg = MBEDTLS_MD_SHA1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    *mgf_md = MBEDTLS_MD_SHA1;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    *salt_len = 20;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/* Make sure params is a SEQUENCE and setup bounds */</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span>( params-&gt;tag != ( MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) )</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> );</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) params-&gt;p;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    end = p + params-&gt;len;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span>( p == end )</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">     * HashAlgorithm</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( &amp;p, end, &amp;len,</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_CONSTRUCTED | 0 ) ) == 0 )</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        end2 = p + len;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">/* HashAlgorithm ::= AlgorithmIdentifier (without parameters) */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">if</span>( ( ret = mbedtls_x509_get_alg_null( &amp;p, end2, &amp;alg_id ) ) != 0 )</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="oid_8h.html#ad17c5466d99de2ea8a9c581ecdfbded1">mbedtls_oid_get_md_alg</a>( &amp;alg_id, md_alg ) ) != 0 )</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span>( p != end2 )</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    <a class="code" href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a> );</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ret != <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> )</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span>( p == end )</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">     * MaskGenAlgorithm</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( &amp;p, end, &amp;len,</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_CONSTRUCTED | 1 ) ) == 0 )</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        end2 = p + len;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">/* MaskGenAlgorithm ::= AlgorithmIdentifier (params = HashAlgorithm) */</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span>( ( ret = mbedtls_x509_get_alg( &amp;p, end2, &amp;alg_id, &amp;alg_params ) ) != 0 )</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">/* Only MFG1 is recognised for now */</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="asn1_8h.html#a0b81f225b3551ec7c4da69b2d183d10b">MBEDTLS_OID_CMP</a>( <a class="code" href="oid_8h.html#a41d20b2f31811636313feeafcd7959b9">MBEDTLS_OID_MGF1</a>, &amp;alg_id ) != 0 )</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga185bc7f27a2b1f7742537a2377c52ee3">MBEDTLS_ERR_X509_FEATURE_UNAVAILABLE</a> +</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <a class="code" href="oid_8h.html#a9a731a2f6abe093916b7b97e79761bdb">MBEDTLS_ERR_OID_NOT_FOUND</a> );</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">/* Parse HashAlgorithm */</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span>( ( ret = x509_get_hash_alg( &amp;alg_params, mgf_md ) ) != 0 )</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">if</span>( p != end2 )</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    <a class="code" href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a> );</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ret != <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> )</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span>( p == end )</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">     * salt_len</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( &amp;p, end, &amp;len,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_CONSTRUCTED | 2 ) ) == 0 )</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        end2 = p + len;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#a7f8a8b447c11f2200cc5aa8033801b72">mbedtls_asn1_get_int</a>( &amp;p, end2, salt_len ) ) != 0 )</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span>( p != end2 )</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <a class="code" href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a> );</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ret != <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> )</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span>( p == end )</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">     * trailer_field (if present, must be 1)</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( &amp;p, end, &amp;len,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_CONSTRUCTED | 3 ) ) == 0 )</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordtype">int</span> trailer_field;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        end2 = p + len;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#a7f8a8b447c11f2200cc5aa8033801b72">mbedtls_asn1_get_int</a>( &amp;p, end2, &amp;trailer_field ) ) != 0 )</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">if</span>( p != end2 )</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                    <a class="code" href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a> );</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">if</span>( trailer_field != 1 )</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> );</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ret != <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> )</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> + ret );</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span>( p != end )</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> +</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                <a class="code" href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a> );</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_RSASSA_PSS_SUPPORT */</span><span class="preprocessor"></span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"> *  AttributeTypeAndValue ::= SEQUENCE {</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"> *    type     AttributeType,</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"> *    value    AttributeValue }</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> *  AttributeType ::= OBJECT IDENTIFIER</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> *  AttributeValue ::= ANY DEFINED BY AttributeType</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> x509_get_attr_type_value( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p,</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                     <a class="code" href="structmbedtls__asn1__named__data.html">mbedtls_x509_name</a> *cur )</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *oid;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *val;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( p, end, &amp;len,</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a> + ret );</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span>( ( end - *p ) &lt; 1 )</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a> +</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <a class="code" href="group__asn1__module.html#ga284c12cf03a4ffeee89a63750f00dfdd">MBEDTLS_ERR_ASN1_OUT_OF_DATA</a> );</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    oid = &amp;cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a0981fcdac0ce14b6922a953adf0624d9">oid</a>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    oid-&gt;<a class="code" href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">tag</a> = **p;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( p, end, &amp;oid-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>, MBEDTLS_ASN1_OID ) ) != 0 )</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a> + ret );</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    oid-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> = *p;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    *p += oid-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span>( ( end - *p ) &lt; 1 )</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a> +</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="group__asn1__module.html#ga284c12cf03a4ffeee89a63750f00dfdd">MBEDTLS_ERR_ASN1_OUT_OF_DATA</a> );</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span>( **p != MBEDTLS_ASN1_BMP_STRING &amp;&amp; **p != MBEDTLS_ASN1_UTF8_STRING      &amp;&amp;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        **p != MBEDTLS_ASN1_T61_STRING &amp;&amp; **p != MBEDTLS_ASN1_PRINTABLE_STRING &amp;&amp;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        **p != MBEDTLS_ASN1_IA5_STRING &amp;&amp; **p != MBEDTLS_ASN1_UNIVERSAL_STRING &amp;&amp;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        **p != MBEDTLS_ASN1_BIT_STRING )</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a> +</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> );</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    val = &amp;cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#ad99636f90fae31a96c26df85a7896b07">val</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    val-&gt;tag = *(*p)++;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ad45c1d0ed3694fe903342cb32647bfb1">mbedtls_asn1_get_len</a>( p, end, &amp;val-&gt;len ) ) != 0 )</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a> + ret );</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    val-&gt;p = *p;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    *p += val-&gt;len;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">next</a> = NULL;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"> *  Name ::= CHOICE { -- only one possibility for now --</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"> *       rdnSequence  RDNSequence }</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> *  RDNSequence ::= SEQUENCE OF RelativeDistinguishedName</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> *  RelativeDistinguishedName ::=</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"> *    SET OF AttributeTypeAndValue</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> *  AttributeTypeAndValue ::= SEQUENCE {</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"> *    type     AttributeType,</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> *    value    AttributeValue }</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> *  AttributeType ::= OBJECT IDENTIFIER</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> *  AttributeValue ::= ANY DEFINED BY AttributeType</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> * The data structure is optimized for the common case where each RDN has only</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"> * one element, which is represented as a list of AttributeTypeAndValue.</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"> * For the general case we still use a flat list, but we mark elements of the</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"> * same set so that they are &quot;merged&quot; together in the functions that consume</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> * this list, eg mbedtls_x509_dn_gets().</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_name( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end,</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                   <a class="code" href="structmbedtls__asn1__named__data.html">mbedtls_x509_name</a> *cur )</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">size_t</span> set_len;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end_set;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">/* don&#39;t use recursion, we&#39;d risk stack overflow if not optimized */</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">while</span>( 1 )</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">         * parse SET</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( p, end, &amp;set_len,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SET ) ) != 0 )</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a> + ret );</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        end_set  = *p + set_len;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">while</span>( 1 )</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">if</span>( ( ret = x509_get_attr_type_value( p, end_set, cur ) ) != 0 )</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">if</span>( *p == end_set )</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="comment">/* Mark this item as being no the only one in a set */</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#aee15b65458fa2c10596ff7c210ba4ee1">next_merged</a> = 1;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">next</a> = mbedtls_calloc( 1, <span class="keyword">sizeof</span>( <a class="code" href="structmbedtls__asn1__named__data.html">mbedtls_x509_name</a> ) );</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordflow">if</span>( cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">next</a> == NULL )</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gacf6d98c6cbb76728260d1dcb1fe3bc7d">MBEDTLS_ERR_X509_ALLOC_FAILED</a> );</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            cur = cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">next</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">         * continue until end of SEQUENCE is reached</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span>( *p == end )</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">next</a> = mbedtls_calloc( 1, <span class="keyword">sizeof</span>( <a class="code" href="structmbedtls__asn1__named__data.html">mbedtls_x509_name</a> ) );</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">if</span>( cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">next</a> == NULL )</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gacf6d98c6cbb76728260d1dcb1fe3bc7d">MBEDTLS_ERR_X509_ALLOC_FAILED</a> );</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        cur = cur-&gt;<a class="code" href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">next</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> x509_parse_int(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keywordtype">unsigned</span> n, <span class="keywordtype">int</span> *res){</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    *res = 0;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">for</span>( ; n &gt; 0; --n ){</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">if</span>( ( **p &lt; <span class="charliteral">&#39;0&#39;</span>) || ( **p &gt; <span class="charliteral">&#39;9&#39;</span> ) ) <span class="keywordflow">return</span> <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        *res *= 10;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        *res += (*(*p)++ - <span class="charliteral">&#39;0&#39;</span>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> x509_date_is_valid(<span class="keyword">const</span> <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *time)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;{</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    CHECK_RANGE( 0, 9999, time-&gt;year );</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    CHECK_RANGE( 0, 23,   time-&gt;hour );</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    CHECK_RANGE( 0, 59,   time-&gt;min  );</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    CHECK_RANGE( 0, 59,   time-&gt;<a class="code" href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">sec</a>  );</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">switch</span>( time-&gt;mon )</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">case</span> 1: <span class="keywordflow">case</span> 3: <span class="keywordflow">case</span> 5: <span class="keywordflow">case</span> 7: <span class="keywordflow">case</span> 8: <span class="keywordflow">case</span> 10: <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            CHECK_RANGE( 1, 31, time-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a> );</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">case</span> 4: <span class="keywordflow">case</span> 6: <span class="keywordflow">case</span> 9: <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            CHECK_RANGE( 1, 30, time-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a> );</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            CHECK_RANGE( 1, 28 + (time-&gt;year % 4 == 0), time-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a> );</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;}</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"> *  Time ::= CHOICE {</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"> *       utcTime        UTCTime,</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"> *       generalTime    GeneralizedTime }</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_time( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end,</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                   <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *time )</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> tag;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span>( ( end - *p ) &lt; 1 )</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a> +</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <a class="code" href="group__asn1__module.html#ga284c12cf03a4ffeee89a63750f00dfdd">MBEDTLS_ERR_ASN1_OUT_OF_DATA</a> );</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    tag = **p;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span>( tag == MBEDTLS_ASN1_UTC_TIME )</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        (*p)++;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        ret = <a class="code" href="asn1_8h.html#ad45c1d0ed3694fe903342cb32647bfb1">mbedtls_asn1_get_len</a>( p, end, &amp;len );</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a> + ret );</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;year ) );</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;mon ) );</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a> ) );</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;hour ) );</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;min ) );</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">if</span>( len &gt; 10 )</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            CHECK( x509_parse_int( p, 2, &amp;time-&gt;<a class="code" href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">sec</a> ) );</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">if</span>( len &gt; 12 &amp;&amp; *(*p)++ != <span class="charliteral">&#39;Z&#39;</span> )</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a> );</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        time-&gt;year +=  100 * ( time-&gt;year &lt; 50 );</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        time-&gt;year += 1900;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        CHECK( x509_date_is_valid( time ) );</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( tag == MBEDTLS_ASN1_GENERALIZED_TIME )</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        (*p)++;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        ret = <a class="code" href="asn1_8h.html#ad45c1d0ed3694fe903342cb32647bfb1">mbedtls_asn1_get_len</a>( p, end, &amp;len );</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a> + ret );</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        CHECK( x509_parse_int( p, 4, &amp;time-&gt;year ) );</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;mon ) );</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a> ) );</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;hour ) );</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        CHECK( x509_parse_int( p, 2, &amp;time-&gt;min ) );</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">if</span>( len &gt; 12 )</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            CHECK( x509_parse_int( p, 2, &amp;time-&gt;<a class="code" href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">sec</a> ) );</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">if</span>( len &gt; 14 &amp;&amp; *(*p)++ != <span class="charliteral">&#39;Z&#39;</span> )</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a> );</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        CHECK( x509_date_is_valid( time ) );</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a> +</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <a class="code" href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a> );</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_sig( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end, <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *sig )</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;{</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">int</span> tag_type;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">if</span>( ( end - *p ) &lt; 1 )</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga022c175386f082b4e056e6268ee68cab">MBEDTLS_ERR_X509_INVALID_SIGNATURE</a> +</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <a class="code" href="group__asn1__module.html#ga284c12cf03a4ffeee89a63750f00dfdd">MBEDTLS_ERR_ASN1_OUT_OF_DATA</a> );</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    tag_type = **p;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#a0f9d2d846b16d5ce18ad99de6224313b">mbedtls_asn1_get_bitstring_null</a>( p, end, &amp;len ) ) != 0 )</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga022c175386f082b4e056e6268ee68cab">MBEDTLS_ERR_X509_INVALID_SIGNATURE</a> + ret );</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    sig-&gt;tag = tag_type;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    sig-&gt;len = len;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    sig-&gt;p = *p;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    *p += len;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;}</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"> * Get signature algorithm from alg OID and optional parameters</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_sig_alg( <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *sig_oid, <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *sig_params,</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                      mbedtls_md_type_t *md_alg, <a class="code" href="pk_8h.html#a3fe41eff5605ae727eb9d28dad297020">mbedtls_pk_type_t</a> *pk_alg,</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                      <span class="keywordtype">void</span> **sig_opts )</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;{</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">if</span>( *sig_opts != NULL )</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gaeeef11ebf0b31a54a665b1a3fd65c3f7">MBEDTLS_ERR_X509_BAD_INPUT_DATA</a> );</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="oid_8h.html#abc3e1ab713f5693308de415bbde0d5a0">mbedtls_oid_get_sig_alg</a>( sig_oid, md_alg, pk_alg ) ) != 0 )</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#ga488f8616b42eae6fe3fb9815d43c976f">MBEDTLS_ERR_X509_UNKNOWN_SIG_ALG</a> + ret );</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_RSASSA_PSS_SUPPORT)</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">if</span>( *pk_alg == MBEDTLS_PK_RSASSA_PSS )</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="structmbedtls__pk__rsassa__pss__options.html">mbedtls_pk_rsassa_pss_options</a> *pss_opts;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        pss_opts = mbedtls_calloc( 1, <span class="keyword">sizeof</span>( <a class="code" href="structmbedtls__pk__rsassa__pss__options.html">mbedtls_pk_rsassa_pss_options</a> ) );</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">if</span>( pss_opts == NULL )</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gacf6d98c6cbb76728260d1dcb1fe3bc7d">MBEDTLS_ERR_X509_ALLOC_FAILED</a> );</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        ret = mbedtls_x509_get_rsassa_pss_params( sig_params,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                          md_alg,</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                          &amp;pss_opts-&gt;mgf1_hash_id,</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                          &amp;pss_opts-&gt;expected_salt_len );</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            mbedtls_free( pss_opts );</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        *sig_opts = (<span class="keywordtype">void</span> *) pss_opts;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_RSASSA_PSS_SUPPORT */</span><span class="preprocessor"></span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">/* Make sure parameters are absent or NULL */</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span>( ( sig_params-&gt;<a class="code" href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">tag</a> != MBEDTLS_ASN1_NULL &amp;&amp; sig_params-&gt;<a class="code" href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">tag</a> != 0 ) ||</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;              sig_params-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> != 0 )</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a> );</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;}</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> * X.509 Extensions (No parsing of extensions, pointer should</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> * be either manually updated or extensions should be parsed!</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_get_ext( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> **p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *end,</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                  <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *ext, <span class="keywordtype">int</span> tag )</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;{</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">size_t</span> len;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span>( *p == end )</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    ext-&gt;<a class="code" href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">tag</a> = **p;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( p, end, &amp;ext-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>,</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            MBEDTLS_ASN1_CONTEXT_SPECIFIC | MBEDTLS_ASN1_CONSTRUCTED | tag ) ) != 0 )</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    ext-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> = *p;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    end = *p + ext-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">     * Extensions  ::=  SEQUENCE SIZE (1..MAX) OF Extension</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">     *</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">     * Extension  ::=  SEQUENCE  {</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">     *      extnID      OBJECT IDENTIFIER,</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">     *      critical    BOOLEAN DEFAULT FALSE,</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">     *      extnValue   OCTET STRING  }</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span>( ( ret = <a class="code" href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a>( p, end, &amp;len,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            MBEDTLS_ASN1_CONSTRUCTED | MBEDTLS_ASN1_SEQUENCE ) ) != 0 )</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gaa0788dbf0325aea4ab566717514b4422">MBEDTLS_ERR_X509_INVALID_EXTENSIONS</a> + ret );</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span>( end != *p + len )</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="group__x509__module.html#gaa0788dbf0325aea4ab566717514b4422">MBEDTLS_ERR_X509_INVALID_EXTENSIONS</a> +</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                <a class="code" href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a> );</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"> * Store the name in printable form into buf; no more</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"> * than size characters will be written</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_dn_gets( <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> size, <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__named__data.html">mbedtls_x509_name</a> *dn )</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordtype">size_t</span> i, n;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c, merge = 0;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__named__data.html">mbedtls_x509_name</a> *name;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *short_name = NULL;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">char</span> s[MBEDTLS_X509_MAX_DN_NAME_SIZE], *p;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    memset( s, 0, <span class="keyword">sizeof</span>( s ) );</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    name = dn;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    p = buf;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    n = size;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">while</span>( name != NULL )</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span>( !name-&gt;oid.p )</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            name = name-&gt;next;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">if</span>( name != dn )</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            ret = mbedtls_snprintf( p, n, merge ? <span class="stringliteral">&quot; + &quot;</span> : <span class="stringliteral">&quot;, &quot;</span> );</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        ret = <a class="code" href="oid_8h.html#a027b5bb24a69578666631ffea74064a1">mbedtls_oid_get_attr_short_name</a>( &amp;name-&gt;oid, &amp;short_name );</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keywordflow">if</span>( ret == 0 )</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;%s=&quot;</span>, short_name );</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;\?\?=&quot;</span> );</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">for</span>( i = 0; i &lt; name-&gt;val.len; i++ )</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordflow">if</span>( i &gt;= <span class="keyword">sizeof</span>( s ) - 1 )</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            c = name-&gt;val.p[i];</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keywordflow">if</span>( c &lt; 32 || c == 127 || ( c &gt; 128 &amp;&amp; c &lt; 160 ) )</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                 s[i] = <span class="charliteral">&#39;?&#39;</span>;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keywordflow">else</span> s[i] = c;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        s[i] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;%s&quot;</span>, s );</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        merge = name-&gt;next_merged;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        name = name-&gt;next;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">return</span>( (<span class="keywordtype">int</span>) ( size - n ) );</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"> * Store the serial in printable form into buf; no more</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"> * than size characters will be written</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_serial_gets( <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> size, <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *serial )</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;{</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keywordtype">size_t</span> i, n, nr;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    p = buf;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    n = size;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    nr = ( serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> &lt;= 32 )</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        ? serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>  : 28;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">for</span>( i = 0; i &lt; nr; i++ )</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">if</span>( i == 0 &amp;&amp; nr &gt; 1 &amp;&amp; serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a>[i] == 0x0 )</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;%02X%s&quot;</span>,</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a>[i], ( i &lt; nr - 1 ) ? <span class="stringliteral">&quot;:&quot;</span> : <span class="stringliteral">&quot;&quot;</span> );</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span>( nr != serial-&gt;<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> )</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;....&quot;</span> );</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">return</span>( (<span class="keywordtype">int</span>) ( size - n ) );</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;}</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"> * Helper for writing signature algorithms</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_sig_alg_gets( <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> size, <span class="keyword">const</span> <a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a> *sig_oid,</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                       <a class="code" href="pk_8h.html#a3fe41eff5605ae727eb9d28dad297020">mbedtls_pk_type_t</a> pk_alg, mbedtls_md_type_t md_alg,</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">void</span> *sig_opts )</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;{</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordtype">char</span> *p = buf;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordtype">size_t</span> n = size;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *desc = NULL;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    ret = <a class="code" href="oid_8h.html#ae57f97127e29c749decfb384b3928952">mbedtls_oid_get_sig_alg_desc</a>( sig_oid, &amp;desc );</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;???&quot;</span>  );</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;%s&quot;</span>, desc );</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_RSASSA_PSS_SUPPORT)</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">if</span>( pk_alg == MBEDTLS_PK_RSASSA_PSS )</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keyword">const</span> <a class="code" href="structmbedtls__pk__rsassa__pss__options.html">mbedtls_pk_rsassa_pss_options</a> *pss_opts;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keyword">const</span> <a class="code" href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a> *md_info, *mgf_md_info;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        pss_opts = (<span class="keyword">const</span> <a class="code" href="structmbedtls__pk__rsassa__pss__options.html">mbedtls_pk_rsassa_pss_options</a> *) sig_opts;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        md_info = <a class="code" href="md_8h.html#aca53b51e0c8eb0e07c7eb4a3e6acfa0d">mbedtls_md_info_from_type</a>( md_alg );</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        mgf_md_info = <a class="code" href="md_8h.html#aca53b51e0c8eb0e07c7eb4a3e6acfa0d">mbedtls_md_info_from_type</a>( pss_opts-&gt;mgf1_hash_id );</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot; (%s, MGF1-%s, 0x%02X)&quot;</span>,</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                              md_info ? <a class="code" href="md_8h.html#a3ceb9e6b3d4b21612ef5d7532872c6bc">mbedtls_md_get_name</a>( md_info ) : <span class="stringliteral">&quot;???&quot;</span>,</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                              mgf_md_info ? <a class="code" href="md_8h.html#a3ceb9e6b3d4b21612ef5d7532872c6bc">mbedtls_md_get_name</a>( mgf_md_info ) : <span class="stringliteral">&quot;???&quot;</span>,</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                              pss_opts-&gt;expected_salt_len );</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    ((void) pk_alg);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    ((void) md_alg);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    ((void) sig_opts);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_RSASSA_PSS_SUPPORT */</span><span class="preprocessor"></span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">return</span>( (<span class="keywordtype">int</span>)( size - n ) );</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"> * Helper for writing &quot;RSA key size&quot;, &quot;EC key size&quot;, etc</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_key_size_helper( <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> buf_size, <span class="keyword">const</span> <span class="keywordtype">char</span> *name )</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;{</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">char</span> *p = buf;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordtype">size_t</span> n = buf_size;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    ret = mbedtls_snprintf( p, n, <span class="stringliteral">&quot;%s key size&quot;</span>, name );</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    MBEDTLS_X509_SAFE_SNPRINTF;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;}</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME_DATE)</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment"> * Set the time structure to the current time.</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment"> * Return 0 on success, non-zero on failure.</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="preprocessor">#if defined(_WIN32) &amp;&amp; !defined(EFIX64) &amp;&amp; !defined(EFI32)</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> x509_get_current_time( <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *now )</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;{</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    SYSTEMTIME st;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    GetSystemTime( &amp;st );</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    now-&gt;year = st.wYear;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    now-&gt;mon  = st.wMonth;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    now-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  = st.wDay;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    now-&gt;hour = st.wHour;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    now-&gt;min  = st.wMinute;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    now-&gt;<a class="code" href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">sec</a>  = st.wSecond;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;}</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> x509_get_current_time( <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *now )</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;{</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keyword">struct </span>tm *lt;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    mbedtls_time_t tt;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">if</span>( mbedtls_mutex_lock( &amp;mbedtls_threading_gmtime_mutex ) != 0 )</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="threading_8h.html#a51005c51b928706511d3c2ea3390c07f">MBEDTLS_ERR_THREADING_MUTEX_ERROR</a> );</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    tt = mbedtls_time( NULL );</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    lt = gmtime( &amp;tt );</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">if</span>( lt == NULL )</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        ret = -1;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        now-&gt;year = lt-&gt;tm_year + 1900;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        now-&gt;mon  = lt-&gt;tm_mon  + 1;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        now-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  = lt-&gt;tm_mday;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        now-&gt;hour = lt-&gt;tm_hour;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        now-&gt;min  = lt-&gt;tm_min;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        now-&gt;<a class="code" href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">sec</a>  = lt-&gt;tm_sec;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">if</span>( mbedtls_mutex_unlock( &amp;mbedtls_threading_gmtime_mutex ) != 0 )</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="threading_8h.html#a51005c51b928706511d3c2ea3390c07f">MBEDTLS_ERR_THREADING_MUTEX_ERROR</a> );</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* _WIN32 &amp;&amp; !EFIX64 &amp;&amp; !EFI32 */</span><span class="preprocessor"></span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment"> * Return 0 if before &lt;= after, 1 otherwise</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> x509_check_time( <span class="keyword">const</span> <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *before, <span class="keyword">const</span> <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *after )</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;{</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span>( before-&gt;year  &gt; after-&gt;year )</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span>( before-&gt;year == after-&gt;year &amp;&amp;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        before-&gt;mon   &gt; after-&gt;mon )</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordflow">if</span>( before-&gt;year == after-&gt;year &amp;&amp;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        before-&gt;mon  == after-&gt;mon  &amp;&amp;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        before-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>   &gt; after-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a> )</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span>( before-&gt;year == after-&gt;year &amp;&amp;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        before-&gt;mon  == after-&gt;mon  &amp;&amp;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        before-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  == after-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  &amp;&amp;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        before-&gt;hour  &gt; after-&gt;hour )</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">if</span>( before-&gt;year == after-&gt;year &amp;&amp;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        before-&gt;mon  == after-&gt;mon  &amp;&amp;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        before-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  == after-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  &amp;&amp;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        before-&gt;hour == after-&gt;hour &amp;&amp;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        before-&gt;min   &gt; after-&gt;min  )</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span>( before-&gt;year == after-&gt;year &amp;&amp;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        before-&gt;mon  == after-&gt;mon  &amp;&amp;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        before-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  == after-&gt;<a class="code" href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">day</a>  &amp;&amp;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        before-&gt;hour == after-&gt;hour &amp;&amp;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        before-&gt;min  == after-&gt;min  &amp;&amp;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        before-&gt;<a class="code" href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">sec</a>   &gt; after-&gt;<a class="code" href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">sec</a>  )</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;}</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_time_is_past( <span class="keyword">const</span> <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *to )</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;{</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> now;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span>( x509_get_current_time( &amp;now ) != 0 )</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">return</span>( x509_check_time( &amp;now, to ) );</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;}</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_time_is_future( <span class="keyword">const</span> <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *from )</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;{</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> now;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span>( x509_get_current_time( &amp;now ) != 0 )</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">return</span>( x509_check_time( from, &amp;now ) );</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="preprocessor">#else  </span><span class="comment">/* MBEDTLS_HAVE_TIME_DATE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_time_is_past( <span class="keyword">const</span> <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *to )</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;{</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    ((void) to);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;}</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_time_is_future( <span class="keyword">const</span> <a class="code" href="structmbedtls__x509__time.html">mbedtls_x509_time</a> *from )</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;{</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    ((void) from);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;}</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_HAVE_TIME_DATE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_SELF_TEST)</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="x509__crt_8h.html">mbedtls/x509_crt.h</a>&quot;</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="certs_8h.html">mbedtls/certs.h</a>&quot;</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"> * Checkup routine</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="keywordtype">int</span> mbedtls_x509_self_test( <span class="keywordtype">int</span> verbose )</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;{</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_CERTS_C) &amp;&amp; defined(MBEDTLS_SHA1_C)</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    uint32_t flags;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a> cacert;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a> clicert;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">if</span>( verbose != 0 )</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        mbedtls_printf( <span class="stringliteral">&quot;  X.509 certificate load: &quot;</span> );</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <a class="code" href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a>( &amp;clicert );</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    ret = <a class="code" href="group__x509__module.html#ga033567483649030f7f859db4f4cb7e14">mbedtls_x509_crt_parse</a>( &amp;clicert, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) mbedtls_test_cli_crt,</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                           mbedtls_test_cli_crt_len );</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">if</span>( verbose != 0 )</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            mbedtls_printf( <span class="stringliteral">&quot;failed\n&quot;</span> );</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <a class="code" href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a>( &amp;cacert );</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    ret = <a class="code" href="group__x509__module.html#ga033567483649030f7f859db4f4cb7e14">mbedtls_x509_crt_parse</a>( &amp;cacert, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) mbedtls_test_ca_crt,</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                          mbedtls_test_ca_crt_len );</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">if</span>( verbose != 0 )</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            mbedtls_printf( <span class="stringliteral">&quot;failed\n&quot;</span> );</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">if</span>( verbose != 0 )</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        mbedtls_printf( <span class="stringliteral">&quot;passed\n  X.509 signature verify: &quot;</span>);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    ret = <a class="code" href="group__x509__module.html#ga98ed4504e4f832b735a230acf54fcde3">mbedtls_x509_crt_verify</a>( &amp;clicert, &amp;cacert, NULL, NULL, &amp;flags, NULL, NULL );</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">if</span>( ret != 0 )</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    {</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keywordflow">if</span>( verbose != 0 )</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            mbedtls_printf( <span class="stringliteral">&quot;failed\n&quot;</span> );</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    }</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">if</span>( verbose != 0 )</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        mbedtls_printf( <span class="stringliteral">&quot;passed\n\n&quot;</span>);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a>( &amp;cacert  );</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <a class="code" href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a>( &amp;clicert );</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    ((void) verbose);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_CERTS_C &amp;&amp; MBEDTLS_SHA1_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_SELF_TEST */</span><span class="preprocessor"></span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_USE_C */</span><span class="preprocessor"></span></div><div class="ttc" id="structmbedtls__pk__rsassa__pss__options_html"><div class="ttname"><a href="structmbedtls__pk__rsassa__pss__options.html">mbedtls_pk_rsassa_pss_options</a></div><div class="ttdoc">Options for RSASSA-PSS signature verification. See mbedtls_rsa_rsassa_pss_verify_ext() ...</div><div class="ttdef"><b>Definition:</b> <a href="pk_8h_source.html#l00088">pk.h:88</a></div></div>
<div class="ttc" id="asn1_8h_html_a0f9d2d846b16d5ce18ad99de6224313b"><div class="ttname"><a href="asn1_8h.html#a0f9d2d846b16d5ce18ad99de6224313b">mbedtls_asn1_get_bitstring_null</a></div><div class="ttdeci">int mbedtls_asn1_get_bitstring_null(unsigned char **p, const unsigned char *end, size_t *len)</div><div class="ttdoc">Retrieve a bitstring ASN.1 tag without unused bits and its value. Updates the pointer to the beginnin...</div></div>
<div class="ttc" id="group__x509__module_html_ga98ed4504e4f832b735a230acf54fcde3"><div class="ttname"><a href="group__x509__module.html#ga98ed4504e4f832b735a230acf54fcde3">mbedtls_x509_crt_verify</a></div><div class="ttdeci">int mbedtls_x509_crt_verify(mbedtls_x509_crt *crt, mbedtls_x509_crt *trust_ca, mbedtls_x509_crl *ca_crl, const char *cn, uint32_t *flags, int(*f_vrfy)(void *, mbedtls_x509_crt *, int, uint32_t *), void *p_vrfy)</div><div class="ttdoc">Verify the certificate signature. </div></div>
<div class="ttc" id="structmbedtls__asn1__named__data_html_a0981fcdac0ce14b6922a953adf0624d9"><div class="ttname"><a href="structmbedtls__asn1__named__data.html#a0981fcdac0ce14b6922a953adf0624d9">mbedtls_asn1_named_data::oid</a></div><div class="ttdeci">mbedtls_asn1_buf oid</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00152">asn1.h:152</a></div></div>
<div class="ttc" id="structmbedtls__asn1__named__data_html_aee15b65458fa2c10596ff7c210ba4ee1"><div class="ttname"><a href="structmbedtls__asn1__named__data.html#aee15b65458fa2c10596ff7c210ba4ee1">mbedtls_asn1_named_data::next_merged</a></div><div class="ttdeci">unsigned char next_merged</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00155">asn1.h:155</a></div></div>
<div class="ttc" id="group__x509__module_html_gac36bf085ce8f7f57f039bda8828bd824"><div class="ttname"><a href="group__x509__module.html#gac36bf085ce8f7f57f039bda8828bd824">MBEDTLS_ERR_X509_INVALID_DATE</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_INVALID_DATE</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00067">x509.h:67</a></div></div>
<div class="ttc" id="asn1_8h_html_add253579640ea717f368d9a0f6085be0"><div class="ttname"><a href="asn1_8h.html#add253579640ea717f368d9a0f6085be0">mbedtls_asn1_get_alg</a></div><div class="ttdeci">int mbedtls_asn1_get_alg(unsigned char **p, const unsigned char *end, mbedtls_asn1_buf *alg, mbedtls_asn1_buf *params)</div><div class="ttdoc">Retrieve an AlgorithmIdentifier ASN.1 sequence. Updates the pointer to immediately behind the full Al...</div></div>
<div class="ttc" id="structmbedtls__asn1__buf_html_a0af0cf9b0801a21ce4652e859876f195"><div class="ttname"><a href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">mbedtls_asn1_buf::p</a></div><div class="ttdeci">unsigned char * p</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00122">asn1.h:122</a></div></div>
<div class="ttc" id="asn1_8h_html_ae8d7dd42a3b99b61d2ef60bc0c2eaf0d"><div class="ttname"><a href="asn1_8h.html#ae8d7dd42a3b99b61d2ef60bc0c2eaf0d">mbedtls_asn1_get_tag</a></div><div class="ttdeci">int mbedtls_asn1_get_tag(unsigned char **p, const unsigned char *end, size_t *len, int tag)</div><div class="ttdoc">Get the tag and length of the tag. Check for the requested tag. Updates the pointer to immediately be...</div></div>
<div class="ttc" id="group__x509__module_html_gacf6d98c6cbb76728260d1dcb1fe3bc7d"><div class="ttname"><a href="group__x509__module.html#gacf6d98c6cbb76728260d1dcb1fe3bc7d">MBEDTLS_ERR_X509_ALLOC_FAILED</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_ALLOC_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00076">x509.h:76</a></div></div>
<div class="ttc" id="oid_8h_html_abc3e1ab713f5693308de415bbde0d5a0"><div class="ttname"><a href="oid_8h.html#abc3e1ab713f5693308de415bbde0d5a0">mbedtls_oid_get_sig_alg</a></div><div class="ttdeci">int mbedtls_oid_get_sig_alg(const mbedtls_asn1_buf *oid, mbedtls_md_type_t *md_alg, mbedtls_pk_type_t *pk_alg)</div><div class="ttdoc">Translate SignatureAlgorithm OID into md_type and pk_type. </div></div>
<div class="ttc" id="structmbedtls__asn1__buf_html_abcca2df9a773acd5b59831ac55993dd1"><div class="ttname"><a href="structmbedtls__asn1__buf.html#abcca2df9a773acd5b59831ac55993dd1">mbedtls_asn1_buf::tag</a></div><div class="ttdeci">int tag</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00120">asn1.h:120</a></div></div>
<div class="ttc" id="pk_8h_html_a3fe41eff5605ae727eb9d28dad297020"><div class="ttname"><a href="pk_8h.html#a3fe41eff5605ae727eb9d28dad297020">mbedtls_pk_type_t</a></div><div class="ttdeci">mbedtls_pk_type_t</div><div class="ttdoc">Public key types. </div><div class="ttdef"><b>Definition:</b> <a href="pk_8h_source.html#l00074">pk.h:74</a></div></div>
<div class="ttc" id="platform_8h_html"><div class="ttname"><a href="platform_8h.html">platform.h</a></div><div class="ttdoc">mbed TLS Platform abstraction layer </div></div>
<div class="ttc" id="asn1_8h_html_adad023ecf92a50d47eaf206705efdb0e"><div class="ttname"><a href="asn1_8h.html#adad023ecf92a50d47eaf206705efdb0e">mbedtls_asn1_get_alg_null</a></div><div class="ttdeci">int mbedtls_asn1_get_alg_null(unsigned char **p, const unsigned char *end, mbedtls_asn1_buf *alg)</div><div class="ttdoc">Retrieve an AlgorithmIdentifier ASN.1 sequence with NULL or no params. Updates the pointer to immedia...</div></div>
<div class="ttc" id="group__asn1__module_html_gacf6fad8d80fa050c3463539412674a20"><div class="ttname"><a href="group__asn1__module.html#gacf6fad8d80fa050c3463539412674a20">MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</a></div><div class="ttdeci">#define MBEDTLS_ERR_ASN1_LENGTH_MISMATCH</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00053">asn1.h:53</a></div></div>
<div class="ttc" id="oid_8h_html"><div class="ttname"><a href="oid_8h.html">oid.h</a></div><div class="ttdoc">Object Identifier (OID) database. </div></div>
<div class="ttc" id="structmbedtls__asn1__named__data_html"><div class="ttname"><a href="structmbedtls__asn1__named__data.html">mbedtls_asn1_named_data</a></div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00150">asn1.h:150</a></div></div>
<div class="ttc" id="group__x509__module_html_gab33c1e4e20bea7ce536119f54a113c6b"><div class="ttname"><a href="group__x509__module.html#gab33c1e4e20bea7ce536119f54a113c6b">mbedtls_x509_crt_free</a></div><div class="ttdeci">void mbedtls_x509_crt_free(mbedtls_x509_crt *crt)</div><div class="ttdoc">Unallocate all certificate data. </div></div>
<div class="ttc" id="group__asn1__module_html_ga284c12cf03a4ffeee89a63750f00dfdd"><div class="ttname"><a href="group__asn1__module.html#ga284c12cf03a4ffeee89a63750f00dfdd">MBEDTLS_ERR_ASN1_OUT_OF_DATA</a></div><div class="ttdeci">#define MBEDTLS_ERR_ASN1_OUT_OF_DATA</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00050">asn1.h:50</a></div></div>
<div class="ttc" id="group__x509__module_html_gaa0788dbf0325aea4ab566717514b4422"><div class="ttname"><a href="group__x509__module.html#gaa0788dbf0325aea4ab566717514b4422">MBEDTLS_ERR_X509_INVALID_EXTENSIONS</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_INVALID_EXTENSIONS</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00069">x509.h:69</a></div></div>
<div class="ttc" id="group__x509__module_html_ga033567483649030f7f859db4f4cb7e14"><div class="ttname"><a href="group__x509__module.html#ga033567483649030f7f859db4f4cb7e14">mbedtls_x509_crt_parse</a></div><div class="ttdeci">int mbedtls_x509_crt_parse(mbedtls_x509_crt *chain, const unsigned char *buf, size_t buflen)</div><div class="ttdoc">Parse one or more certificates and add them to the chained list. Parses permissively. If some certificates can be parsed, the result is the number of failed certificates it encountered. If none complete correctly, the first error is returned. </div></div>
<div class="ttc" id="asn1_8h_html"><div class="ttname"><a href="asn1_8h.html">asn1.h</a></div><div class="ttdoc">Generic ASN.1 parsing. </div></div>
<div class="ttc" id="structmbedtls__asn1__buf_html"><div class="ttname"><a href="structmbedtls__asn1__buf.html">mbedtls_asn1_buf</a></div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00118">asn1.h:118</a></div></div>
<div class="ttc" id="structmbedtls__x509__time_html"><div class="ttname"><a href="structmbedtls__x509__time.html">mbedtls_x509_time</a></div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00206">x509.h:206</a></div></div>
<div class="ttc" id="oid_8h_html_ad17c5466d99de2ea8a9c581ecdfbded1"><div class="ttname"><a href="oid_8h.html#ad17c5466d99de2ea8a9c581ecdfbded1">mbedtls_oid_get_md_alg</a></div><div class="ttdeci">int mbedtls_oid_get_md_alg(const mbedtls_asn1_buf *oid, mbedtls_md_type_t *md_alg)</div><div class="ttdoc">Translate hash algorithm OID into md_type. </div></div>
<div class="ttc" id="oid_8h_html_a41d20b2f31811636313feeafcd7959b9"><div class="ttname"><a href="oid_8h.html#a41d20b2f31811636313feeafcd7959b9">MBEDTLS_OID_MGF1</a></div><div class="ttdeci">#define MBEDTLS_OID_MGF1</div><div class="ttdef"><b>Definition:</b> <a href="oid_8h_source.html#l00212">oid.h:212</a></div></div>
<div class="ttc" id="structmbedtls__x509__time_html_a20712c77a94123d4610c87d6863cf092"><div class="ttname"><a href="structmbedtls__x509__time.html#a20712c77a94123d4610c87d6863cf092">mbedtls_x509_time::day</a></div><div class="ttdeci">int day</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00208">x509.h:208</a></div></div>
<div class="ttc" id="structmbedtls__asn1__named__data_html_ad99636f90fae31a96c26df85a7896b07"><div class="ttname"><a href="structmbedtls__asn1__named__data.html#ad99636f90fae31a96c26df85a7896b07">mbedtls_asn1_named_data::val</a></div><div class="ttdeci">mbedtls_asn1_buf val</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00153">asn1.h:153</a></div></div>
<div class="ttc" id="x509__crt_8h_html"><div class="ttname"><a href="x509__crt_8h.html">x509_crt.h</a></div><div class="ttdoc">X.509 certificate parsing and writing. </div></div>
<div class="ttc" id="structmbedtls__x509__time_html_a267d51d8fbecde50b06b883db7f98ec2"><div class="ttname"><a href="structmbedtls__x509__time.html#a267d51d8fbecde50b06b883db7f98ec2">mbedtls_x509_time::sec</a></div><div class="ttdeci">int sec</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00209">x509.h:209</a></div></div>
<div class="ttc" id="md_8h_html_a3ceb9e6b3d4b21612ef5d7532872c6bc"><div class="ttname"><a href="md_8h.html#a3ceb9e6b3d4b21612ef5d7532872c6bc">mbedtls_md_get_name</a></div><div class="ttdeci">const char * mbedtls_md_get_name(const mbedtls_md_info_t *md_info)</div><div class="ttdoc">Returns the name of the message digest output. </div></div>
<div class="ttc" id="oid_8h_html_a9a731a2f6abe093916b7b97e79761bdb"><div class="ttname"><a href="oid_8h.html#a9a731a2f6abe093916b7b97e79761bdb">MBEDTLS_ERR_OID_NOT_FOUND</a></div><div class="ttdeci">#define MBEDTLS_ERR_OID_NOT_FOUND</div><div class="ttdef"><b>Definition:</b> <a href="oid_8h_source.html#l00049">oid.h:49</a></div></div>
<div class="ttc" id="oid_8h_html_ae57f97127e29c749decfb384b3928952"><div class="ttname"><a href="oid_8h.html#ae57f97127e29c749decfb384b3928952">mbedtls_oid_get_sig_alg_desc</a></div><div class="ttdeci">int mbedtls_oid_get_sig_alg_desc(const mbedtls_asn1_buf *oid, const char **desc)</div><div class="ttdoc">Translate SignatureAlgorithm OID into description. </div></div>
<div class="ttc" id="asn1_8h_html_a7f8a8b447c11f2200cc5aa8033801b72"><div class="ttname"><a href="asn1_8h.html#a7f8a8b447c11f2200cc5aa8033801b72">mbedtls_asn1_get_int</a></div><div class="ttdeci">int mbedtls_asn1_get_int(unsigned char **p, const unsigned char *end, int *val)</div><div class="ttdoc">Retrieve an integer ASN.1 tag and its value. Updates the pointer to immediately behind the full tag...</div></div>
<div class="ttc" id="oid_8h_html_a027b5bb24a69578666631ffea74064a1"><div class="ttname"><a href="oid_8h.html#a027b5bb24a69578666631ffea74064a1">mbedtls_oid_get_attr_short_name</a></div><div class="ttdeci">int mbedtls_oid_get_attr_short_name(const mbedtls_asn1_buf *oid, const char **short_name)</div><div class="ttdoc">Translate an X.509 attribute type OID into the short name (e.g. the OID for an X520 Common Name into ...</div></div>
<div class="ttc" id="md_8h_html_aca53b51e0c8eb0e07c7eb4a3e6acfa0d"><div class="ttname"><a href="md_8h.html#aca53b51e0c8eb0e07c7eb4a3e6acfa0d">mbedtls_md_info_from_type</a></div><div class="ttdeci">const mbedtls_md_info_t * mbedtls_md_info_from_type(mbedtls_md_type_t md_type)</div><div class="ttdoc">Returns the message digest information associated with the given digest type. </div></div>
<div class="ttc" id="threading_8h_html_a51005c51b928706511d3c2ea3390c07f"><div class="ttname"><a href="threading_8h.html#a51005c51b928706511d3c2ea3390c07f">MBEDTLS_ERR_THREADING_MUTEX_ERROR</a></div><div class="ttdeci">#define MBEDTLS_ERR_THREADING_MUTEX_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="threading_8h_source.html#l00040">threading.h:40</a></div></div>
<div class="ttc" id="certs_8h_html"><div class="ttname"><a href="certs_8h.html">certs.h</a></div><div class="ttdoc">Sample certificates and DHM parameters for testing. </div></div>
<div class="ttc" id="group__x509__module_html_ga488f8616b42eae6fe3fb9815d43c976f"><div class="ttname"><a href="group__x509__module.html#ga488f8616b42eae6fe3fb9815d43c976f">MBEDTLS_ERR_X509_UNKNOWN_SIG_ALG</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_UNKNOWN_SIG_ALG</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00071">x509.h:71</a></div></div>
<div class="ttc" id="asn1_8h_html_a0b81f225b3551ec7c4da69b2d183d10b"><div class="ttname"><a href="asn1_8h.html#a0b81f225b3551ec7c4da69b2d183d10b">MBEDTLS_OID_CMP</a></div><div class="ttdeci">#define MBEDTLS_OID_CMP(oid_str, oid_buf)</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00102">asn1.h:102</a></div></div>
<div class="ttc" id="structmbedtls__asn1__buf_html_a046821787f2c5ecbf2df9f15e0d9486c"><div class="ttname"><a href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">mbedtls_asn1_buf::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00121">asn1.h:121</a></div></div>
<div class="ttc" id="asn1_8h_html_ad45c1d0ed3694fe903342cb32647bfb1"><div class="ttname"><a href="asn1_8h.html#ad45c1d0ed3694fe903342cb32647bfb1">mbedtls_asn1_get_len</a></div><div class="ttdeci">int mbedtls_asn1_get_len(unsigned char **p, const unsigned char *end, size_t *len)</div><div class="ttdoc">Get the length of an ASN.1 element. Updates the pointer to immediately behind the length...</div></div>
<div class="ttc" id="structmbedtls__x509__crt_html"><div class="ttname"><a href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a></div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00052">x509_crt.h:52</a></div></div>
<div class="ttc" id="structmbedtls__md__info__t_html"><div class="ttname"><a href="structmbedtls__md__info__t.html">mbedtls_md_info_t</a></div><div class="ttdef"><b>Definition:</b> <a href="md__internal_8h_source.html#l00046">md_internal.h:46</a></div></div>
<div class="ttc" id="group__asn1__module_html_gab055945fda47ad0e16dc59f8c5ecb86e"><div class="ttname"><a href="group__asn1__module.html#gab055945fda47ad0e16dc59f8c5ecb86e">MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</a></div><div class="ttdeci">#define MBEDTLS_ERR_ASN1_UNEXPECTED_TAG</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00051">asn1.h:51</a></div></div>
<div class="ttc" id="structmbedtls__asn1__named__data_html_a38f29c37c55319b3c0a9c998c3e5bd0d"><div class="ttname"><a href="structmbedtls__asn1__named__data.html#a38f29c37c55319b3c0a9c998c3e5bd0d">mbedtls_asn1_named_data::next</a></div><div class="ttdeci">struct mbedtls_asn1_named_data * next</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00154">asn1.h:154</a></div></div>
<div class="ttc" id="group__x509__module_html_ga8f61c2f303bf065af4f783e03f952ede"><div class="ttname"><a href="group__x509__module.html#ga8f61c2f303bf065af4f783e03f952ede">MBEDTLS_ERR_X509_INVALID_NAME</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_INVALID_NAME</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00066">x509.h:66</a></div></div>
<div class="ttc" id="group__x509__module_html_ga016dd06bc770e77b84005f305df20ed1"><div class="ttname"><a href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a></div><div class="ttdeci">void mbedtls_x509_crt_init(mbedtls_x509_crt *crt)</div><div class="ttdoc">Initialize a certificate (chain) </div></div>
<div class="ttc" id="group__x509__module_html_gae16cddbd42e08f6dd093cf4326e59413"><div class="ttname"><a href="group__x509__module.html#gae16cddbd42e08f6dd093cf4326e59413">MBEDTLS_ERR_X509_INVALID_ALG</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_INVALID_ALG</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00065">x509.h:65</a></div></div>
<div class="ttc" id="platform__time_8h_html"><div class="ttname"><a href="platform__time_8h.html">platform_time.h</a></div><div class="ttdoc">mbed TLS Platform time abstraction </div></div>
<div class="ttc" id="group__x509__module_html_gaeeef11ebf0b31a54a665b1a3fd65c3f7"><div class="ttname"><a href="group__x509__module.html#gaeeef11ebf0b31a54a665b1a3fd65c3f7">MBEDTLS_ERR_X509_BAD_INPUT_DATA</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_BAD_INPUT_DATA</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00075">x509.h:75</a></div></div>
<div class="ttc" id="group__x509__module_html_ga022c175386f082b4e056e6268ee68cab"><div class="ttname"><a href="group__x509__module.html#ga022c175386f082b4e056e6268ee68cab">MBEDTLS_ERR_X509_INVALID_SIGNATURE</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_INVALID_SIGNATURE</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00068">x509.h:68</a></div></div>
<div class="ttc" id="group__x509__module_html_ga8124a68edabf35ed9323880584128f16"><div class="ttname"><a href="group__x509__module.html#ga8124a68edabf35ed9323880584128f16">MBEDTLS_ERR_X509_INVALID_SERIAL</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_INVALID_SERIAL</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00064">x509.h:64</a></div></div>
<div class="ttc" id="group__x509__module_html_ga185bc7f27a2b1f7742537a2377c52ee3"><div class="ttname"><a href="group__x509__module.html#ga185bc7f27a2b1f7742537a2377c52ee3">MBEDTLS_ERR_X509_FEATURE_UNAVAILABLE</a></div><div class="ttdeci">#define MBEDTLS_ERR_X509_FEATURE_UNAVAILABLE</div><div class="ttdef"><b>Definition:</b> <a href="mbedtls_2x509_8h_source.html#l00060">x509.h:60</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
