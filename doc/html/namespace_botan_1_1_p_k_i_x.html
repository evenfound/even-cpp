<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>even-network: Botan::PKIX Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="2018-12-27 at 10-36-23.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">even-network
   </div>
   <div id="projectbrief">EVEN Network â€” is an open cross-chain platform with EVEN cryptocurrency that allows users to interact with more than one blockchain at a time.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_botan.html">Botan</a></li><li class="navelem"><a class="el" href="namespace_botan_1_1_p_k_i_x.html">PKIX</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Botan::PKIX Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0088a8298180d3f9cfb6a8f1c0cd3253"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_botan.html#ae1e907dc90937bdda30f65216e68ff2b">Certificate_Status_Code</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_botan_1_1_p_k_i_x.html#a0088a8298180d3f9cfb6a8f1c0cd3253">build_all_certificate_paths</a> (std::vector&lt; std::vector&lt; std::shared_ptr&lt; const X509_Certificate &gt;&gt;&gt; &amp;cert_paths, const std::vector&lt; Certificate_Store *&gt; &amp;trusted_certstores, const std::shared_ptr&lt; const X509_Certificate &gt; &amp;end_entity, const std::vector&lt; std::shared_ptr&lt; const X509_Certificate &gt;&gt; &amp;end_entity_extra)</td></tr>
<tr class="separator:a0088a8298180d3f9cfb6a8f1c0cd3253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89b961cb12e496c942682134924ad40"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_botan.html#ae1e907dc90937bdda30f65216e68ff2b">Certificate_Status_Code</a> BOTAN_PUBLIC_API(2, 0) build_certificate_path(std <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> BOTAN_PUBLIC_API(2, 0) check_chain(const std <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> BOTAN_PUBLIC_API(2, 0) check_ocsp(const std <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> BOTAN_PUBLIC_API(2, 0) check_crl(const std <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> BOTAN_PUBLIC_API(2, 0) check_crl(const std <a class="el" href="namespace_botan.html#ae1e907dc90937bdda30f65216e68ff2b">Certificate_Status_Code</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_botan_1_1_p_k_i_x.html#aa89b961cb12e496c942682134924ad40">BOTAN_PUBLIC_API</a> (2, 0) overall_status(const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> &amp;cert_status)</td></tr>
<tr class="separator:aa89b961cb12e496c942682134924ad40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a44fb410b4f57b3cb8cbf7cfb31ce9a24"><td class="memItemLeft" align="right" valign="top"><a id="a44fb410b4f57b3cb8cbf7cfb31ce9a24"></a>
void const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>crl_status</b></td></tr>
<tr class="separator:a44fb410b4f57b3cb8cbf7cfb31ce9a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd1a7e92082beda13ef61dd3bc2cb220"><td class="memItemLeft" align="right" valign="top"><a id="abd1a7e92082beda13ef61dd3bc2cb220"></a>
void const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>ocsp_status</b></td></tr>
<tr class="separator:abd1a7e92082beda13ef61dd3bc2cb220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7a891ad4c6e2a83e1cdd7bf4be0d532"><td class="memItemLeft" align="right" valign="top"><a id="ab7a891ad4c6e2a83e1cdd7bf4be0d532"></a>
void const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> bool&#160;</td><td class="memItemRight" valign="bottom"><b>require_rev_on_end_entity</b></td></tr>
<tr class="separator:ab7a891ad4c6e2a83e1cdd7bf4be0d532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7693a8b765b069367dd8f2c8cbc4b2d0"><td class="memItemLeft" align="right" valign="top"><a id="a7693a8b765b069367dd8f2c8cbc4b2d0"></a>
void const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> const <a class="el" href="namespace_botan.html#a013252aabcb201e0d27b60b1e690886b">CertificatePathStatusCodes</a> bool bool&#160;</td><td class="memItemRight" valign="bottom"><b>require_rev_on_intermediates</b></td></tr>
<tr class="separator:a7693a8b765b069367dd8f2c8cbc4b2d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>namespace <a class="el" href="namespace_botan_1_1_p_k_i_x.html">PKIX</a> holds the building blocks that are called by x509_path_validate. This allows custom validation logic to be written by applications and makes for easier testing, but unless you're positive you know what you're doing you probably want to just call x509_path_validate instead. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa89b961cb12e496c942682134924ad40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89b961cb12e496c942682134924ad40">&#9670;&nbsp;</a></span>BOTAN_PUBLIC_API()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Botan::PKIX::BOTAN_PUBLIC_API </td>
          <td>(</td>
          <td class="paramtype">2&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">0&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const &amp;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build certificate path </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert_path_out</td><td>output parameter, cert_path will be appended to this vector </td></tr>
    <tr><td class="paramname">trusted_certstores</td><td>list of certificate stores that contain trusted certificates </td></tr>
    <tr><td class="paramname">end_entity</td><td>the cert to be validated </td></tr>
    <tr><td class="paramname">end_entity_extra</td><td>optional list of additional untrusted certs for path building </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>result of the path building operation (OK or error) Check the certificate chain, but not any revocation data</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert_path</td><td>path built by build_certificate_path with OK result </td></tr>
    <tr><td class="paramname">ref_time</td><td>whatever time you want to perform the validation against (normally current system clock) </td></tr>
    <tr><td class="paramname">hostname</td><td>the hostname </td></tr>
    <tr><td class="paramname">usage</td><td>end entity usage checks </td></tr>
    <tr><td class="paramname">min_signature_algo_strength</td><td>80 or 110 typically Note 80 allows 1024 bit RSA and SHA-1. 110 allows 2048 bit RSA and SHA-2. Using 128 requires ECC (P-256) or ~3000 bit RSA keys. </td></tr>
    <tr><td class="paramname">trusted_hashes</td><td>set of trusted hash functions, empty means accept any hash we have an OID for </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector of results on per certificate in the path, each containing a set of results. If all codes in the set are &lt; Certificate_Status_Code::FIRST_ERROR_STATUS, then the result for that certificate is successful. If all results are Check OCSP responses for revocation information </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert_path</td><td>path already validated by check_chain </td></tr>
    <tr><td class="paramname">ocsp_responses</td><td>the OCSP responses to consider </td></tr>
    <tr><td class="paramname">certstores</td><td>trusted roots </td></tr>
    <tr><td class="paramname">ref_time</td><td>whatever time you want to perform the validation against (normally current system clock) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>revocation status Check CRLs for revocation information </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert_path</td><td>path already validated by check_chain </td></tr>
    <tr><td class="paramname">crls</td><td>the list of CRLs to check, it is assumed that crls[i] (if not null) is the associated CRL for the subject in cert_path[i]. </td></tr>
    <tr><td class="paramname">ref_time</td><td>whatever time you want to perform the validation against (normally current system clock) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>revocation status Check CRLs for revocation information </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert_path</td><td>path already validated by check_chain </td></tr>
    <tr><td class="paramname">certstores</td><td>a list of certificate stores to query for the CRL </td></tr>
    <tr><td class="paramname">ref_time</td><td>whatever time you want to perform the validation against (normally current system clock) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>revocation status Find overall status (OK, error) of a validation </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert_status</td><td>result of merge_revocation_status or check_chain</td></tr>
  </table>
  </dd>
</dl>
<p>Merge the results from CRL and/or OCSP checks into chain_status </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain_status</td><td>the certificate status </td></tr>
    <tr><td class="paramname">crl_status</td><td>results from check_crl </td></tr>
    <tr><td class="paramname">ocsp_status</td><td>results from check_ocsp </td></tr>
    <tr><td class="paramname">require_rev_on_end_entity</td><td>require valid CRL or OCSP on end-entity cert </td></tr>
    <tr><td class="paramname">require_rev_on_intermediates</td><td>require valid CRL or OCSP on all intermediate certificates </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0088a8298180d3f9cfb6a8f1c0cd3253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0088a8298180d3f9cfb6a8f1c0cd3253">&#9670;&nbsp;</a></span>build_all_certificate_paths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_botan.html#ae1e907dc90937bdda30f65216e68ff2b">Certificate_Status_Code</a> Botan::PKIX::build_all_certificate_paths </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::shared_ptr&lt; const X509_Certificate &gt;&gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>cert_paths_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Certificate_Store *&gt; &amp;&#160;</td>
          <td class="paramname"><em>trusted_certstores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::shared_ptr&lt; const X509_Certificate &gt; &amp;&#160;</td>
          <td class="paramname"><em>end_entity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::shared_ptr&lt; const X509_Certificate &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>end_entity_extra</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build all possible certificate paths from the end certificate to self-signed trusted roots.</p>
<p>All potentially valid paths are put into the cert_paths vector. If no potentially valid paths are found, one of the encountered errors is returned arbitrarily.</p>
<p>todo add a path building function that returns detailed information on errors encountered while building the potentially numerous path candidates.</p>
<p>Basically, a DFS is performed starting from the end certificate. A stack (vector) serves to control the DFS. At the beginning of each iteration, a pair is popped from the stack that contains (1) the next certificate to add to the path (2) a bool that indicates if the certificate is part of a trusted certstore. Ideally, we follow the unique issuer of the current certificate until a trusted root is reached. However, the issuer DN + authority key id need not be unique among the certificates used for building the path. In such a case, we consider all the matching issuers by pushing &lt;IssuerCert, trusted?&gt; on the stack for each of them. </p>

<p class="definition">Definition at line <a class="el" href="x509path_8cpp_source.html#l00613">613</a> of file <a class="el" href="x509path_8cpp_source.html">x509path.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
