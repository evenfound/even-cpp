<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>even-network: prerequisites/c-libp2p/thirdparty/mbedtls/ssl_cache.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="2018-12-27 at 10-36-23.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">even-network
   </div>
   <div id="projectbrief">EVEN Network â€” is an open cross-chain platform with EVEN cryptocurrency that allows users to interact with more than one blockchain at a time.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0dc8670ce003965ad6657bffb381fe41.html">prerequisites</a></li><li class="navelem"><a class="el" href="dir_d3dc2089ddf61d8be1e3bff92bba4632.html">c-libp2p</a></li><li class="navelem"><a class="el" href="dir_3cc4b7e6e8cb3f4ecac6acb546e524a7.html">thirdparty</a></li><li class="navelem"><a class="el" href="dir_e89f8300491e216f523c46c748afd590.html">mbedtls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ssl_cache.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  SSL session cache implementation</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  not use this file except in compliance with the License.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  You may obtain a copy of the License at</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  limitations under the License.</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *  This file is part of mbed TLS (https://tls.mbed.org)</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * These session callbacks use a simple chained list</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * to store and retrieve the session information.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#if !defined(MBEDTLS_CONFIG_FILE)</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;mbedtls/config.h&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include MBEDTLS_CONFIG_FILE</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_SSL_CACHE_C)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_PLATFORM_C)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="platform_8h.html">mbedtls/platform.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#define mbedtls_calloc    calloc</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#define mbedtls_free      free</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ssl__cache_8h.html">mbedtls/ssl_cache.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ssl__cache_8h.html#a90886fd9ad56471c5ebaed2e05086cd5">mbedtls_ssl_cache_init</a>( <a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *cache )</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    memset( cache, 0, <span class="keyword">sizeof</span>( <a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> ) );</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#af5d2f556c477eb510117b4a34c02dba4">timeout</a> = <a class="code" href="ssl__cache_8h.html#a02b027cfb82a0436a19bfeada16cb8db">MBEDTLS_SSL_CACHE_DEFAULT_TIMEOUT</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a5a490fa803aa85541cab7808db43c477">max_entries</a> = <a class="code" href="ssl__cache_8h.html#a03256bf3d0f0c370d6984b441b86567e">MBEDTLS_SSL_CACHE_DEFAULT_MAX_ENTRIES</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    mbedtls_mutex_init( &amp;cache-&gt;mutex );</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ssl__cache_8h.html#af0ab0006ecbbec9405be5566ac16c4b3">mbedtls_ssl_cache_get</a>( <span class="keywordtype">void</span> *data, <a class="code" href="structmbedtls__ssl__session.html">mbedtls_ssl_session</a> *session )</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">int</span> ret = 1;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    mbedtls_time_t t = mbedtls_time( NULL );</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *cache = (<a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *) data;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="structmbedtls__ssl__cache__entry.html">mbedtls_ssl_cache_entry</a> *cur, *entry;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span>( mbedtls_mutex_lock( &amp;cache-&gt;mutex ) != 0 )</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">return</span>( 1 );</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    cur = cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">chain</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    entry = NULL;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">while</span>( cur != NULL )</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        entry = cur;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        cur = cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">next</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">if</span>( cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#af5d2f556c477eb510117b4a34c02dba4">timeout</a> != 0 &amp;&amp;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            (<span class="keywordtype">int</span>) ( t - entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a19cb2ae2020c7bf77ad5cc949d0c8967">timestamp</a> ) &gt; cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#af5d2f556c477eb510117b4a34c02dba4">timeout</a> )</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">if</span>( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#ad91239f4186bd272e3eb441c9c309b9e">ciphersuite</a> != entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#ad91239f4186bd272e3eb441c9c309b9e">ciphersuite</a> ||</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a71b31d138a01adef0ef99f03084da801">compression</a> != entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#a71b31d138a01adef0ef99f03084da801">compression</a> ||</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            session-&gt;<a class="code" href="structmbedtls__ssl__session.html#ad1bc5443b7ac77eadd1df71a69f18ba6">id_len</a> != entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#ad1bc5443b7ac77eadd1df71a69f18ba6">id_len</a> )</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">if</span>( memcmp( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#abd00d63c5fe4ae5dd87cbba60155fbc4">id</a>, entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#abd00d63c5fe4ae5dd87cbba60155fbc4">id</a>,</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#ad1bc5443b7ac77eadd1df71a69f18ba6">id_len</a> ) != 0 )</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        memcpy( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#ae8adb932e053a2179530a8aff8750624">master</a>, entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#ae8adb932e053a2179530a8aff8750624">master</a>, 48 );</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a7767cf999b47eaa545fb6a86b3447a20">verify_result</a> = entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#a7767cf999b47eaa545fb6a86b3447a20">verify_result</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CRT_PARSE_C)</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">         * Restore peer certificate (without rest of the original chain)</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span>( entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> != NULL )</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span>( ( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a> = mbedtls_calloc( 1,</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                 <span class="keyword">sizeof</span>(<a class="code" href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a>) ) ) == NULL )</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                ret = 1;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <a class="code" href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a>( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a> );</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">if</span>( <a class="code" href="group__x509__module.html#ga033567483649030f7f859db4f4cb7e14">mbedtls_x509_crt_parse</a>( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a>, entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a>,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                entry-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> ) != 0 )</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                mbedtls_free( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a> );</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a> = NULL;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                ret = 1;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_CRT_PARSE_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        ret = 0;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;exit:</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span>( mbedtls_mutex_unlock( &amp;cache-&gt;mutex ) != 0 )</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        ret = 1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keywordtype">int</span> <a class="code" href="ssl__cache_8h.html#a896a81cf3107ba7464e6273970c2c1eb">mbedtls_ssl_cache_set</a>( <span class="keywordtype">void</span> *data, <span class="keyword">const</span> <a class="code" href="structmbedtls__ssl__session.html">mbedtls_ssl_session</a> *session )</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">int</span> ret = 1;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    mbedtls_time_t t = time( NULL ), oldest = 0;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="structmbedtls__ssl__cache__entry.html">mbedtls_ssl_cache_entry</a> *old = NULL;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *cache = (<a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *) data;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="structmbedtls__ssl__cache__entry.html">mbedtls_ssl_cache_entry</a> *cur, *prv;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span>( ( ret = mbedtls_mutex_lock( &amp;cache-&gt;mutex ) ) != 0 )</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    cur = cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">chain</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    prv = NULL;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">while</span>( cur != NULL )</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        count++;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span>( cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#af5d2f556c477eb510117b4a34c02dba4">timeout</a> != 0 &amp;&amp;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            (<span class="keywordtype">int</span>) ( t - cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a19cb2ae2020c7bf77ad5cc949d0c8967">timestamp</a> ) &gt; cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#af5d2f556c477eb510117b4a34c02dba4">timeout</a> )</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a19cb2ae2020c7bf77ad5cc949d0c8967">timestamp</a> = t;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">/* expired, reuse this slot, update timestamp */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span>( memcmp( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#abd00d63c5fe4ae5dd87cbba60155fbc4">id</a>, cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#abd00d63c5fe4ae5dd87cbba60155fbc4">id</a>, cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#ad1bc5443b7ac77eadd1df71a69f18ba6">id_len</a> ) == 0 )</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">/* client reconnected, keep timestamp for session id */</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span>( oldest == 0 || cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a19cb2ae2020c7bf77ad5cc949d0c8967">timestamp</a> &lt; oldest )</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            oldest = cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a19cb2ae2020c7bf77ad5cc949d0c8967">timestamp</a>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            old = cur;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        prv = cur;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        cur = cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">next</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span>( cur == NULL )</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">         * Reuse oldest entry if max_entries reached</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span>( count &gt;= cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a5a490fa803aa85541cab7808db43c477">max_entries</a> )</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">if</span>( old == NULL )</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                ret = 1;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            cur = old;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* MBEDTLS_HAVE_TIME */</span><span class="preprocessor"></span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">         * Reuse first entry in chain if max_entries reached,</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">         * but move to last place</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span>( count &gt;= cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a5a490fa803aa85541cab7808db43c477">max_entries</a> )</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">if</span>( cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">chain</a> == NULL )</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                ret = 1;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            cur = cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">chain</a>;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">chain</a> = cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">next</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">next</a> = NULL;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            prv-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">next</a> = cur;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_HAVE_TIME */</span><span class="preprocessor"></span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">             * max_entries not reached, create new entry</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            cur = mbedtls_calloc( 1, <span class="keyword">sizeof</span>(<a class="code" href="structmbedtls__ssl__cache__entry.html">mbedtls_ssl_cache_entry</a>) );</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span>( cur == NULL )</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                ret = 1;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">if</span>( prv == NULL )</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">chain</a> = cur;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                prv-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">next</a> = cur;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a19cb2ae2020c7bf77ad5cc949d0c8967">timestamp</a> = t;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    memcpy( &amp;cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>, session, <span class="keyword">sizeof</span>( <a class="code" href="structmbedtls__ssl__session.html">mbedtls_ssl_session</a> ) );</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CRT_PARSE_C)</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">     * If we&#39;re reusing an entry, free its certificate first</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">if</span>( cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> != NULL )</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        mbedtls_free( cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> );</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        memset( &amp;cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="structmbedtls__asn1__buf.html">mbedtls_x509_buf</a>) );</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">     * Store peer certificate</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">if</span>( session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a> != NULL )</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> = mbedtls_calloc( 1, session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a>-&gt;<a class="code" href="structmbedtls__x509__crt.html#a5bfef6b8b81bc081f796cb1f6bb28839">raw</a>.<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> );</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">if</span>( cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> == NULL )</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            ret = 1;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        memcpy( cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a>, session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a>-&gt;<a class="code" href="structmbedtls__x509__crt.html#a5bfef6b8b81bc081f796cb1f6bb28839">raw</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a>,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a>-&gt;<a class="code" href="structmbedtls__x509__crt.html#a5bfef6b8b81bc081f796cb1f6bb28839">raw</a>.<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> );</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a> = session-&gt;<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a>-&gt;<a class="code" href="structmbedtls__x509__crt.html#a5bfef6b8b81bc081f796cb1f6bb28839">raw</a>.<a class="code" href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">len</a>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a>.<a class="code" href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">peer_cert</a> = NULL;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_CRT_PARSE_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    ret = 0;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;exit:</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span>( mbedtls_mutex_unlock( &amp;cache-&gt;mutex ) != 0 )</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        ret = 1;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span>( ret );</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_HAVE_TIME)</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ssl__cache_8h.html#aa3468c4ebd9484227436014db30b8f5f">mbedtls_ssl_cache_set_timeout</a>( <a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *cache, <span class="keywordtype">int</span> timeout )</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;{</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span>( timeout &lt; 0 ) timeout = 0;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#af5d2f556c477eb510117b4a34c02dba4">timeout</a> = timeout;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_HAVE_TIME */</span><span class="preprocessor"></span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ssl__cache_8h.html#abc39c23cf3f791359104d9094bd9cf6f">mbedtls_ssl_cache_set_max_entries</a>( <a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *cache, <span class="keywordtype">int</span> max )</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span>( max &lt; 0 ) max = 0;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a5a490fa803aa85541cab7808db43c477">max_entries</a> = max;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ssl__cache_8h.html#a93a35f5cd109f9d698bfac659905c0d8">mbedtls_ssl_cache_free</a>( <a class="code" href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a> *cache )</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="structmbedtls__ssl__cache__entry.html">mbedtls_ssl_cache_entry</a> *cur, *prv;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    cur = cache-&gt;<a class="code" href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">chain</a>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">while</span>( cur != NULL )</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        prv = cur;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        cur = cur-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">next</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="ssl_8h.html#ac085defe1a02ab784a0a2fb201bcc741">mbedtls_ssl_session_free</a>( &amp;prv-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">session</a> );</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_X509_CRT_PARSE_C)</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        mbedtls_free( prv-&gt;<a class="code" href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">peer_cert</a>.<a class="code" href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">p</a> );</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_X509_CRT_PARSE_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        mbedtls_free( prv );</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#if defined(MBEDTLS_THREADING_C)</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    mbedtls_mutex_free( &amp;cache-&gt;mutex );</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_SSL_CACHE_C */</span><span class="preprocessor"></span></div><div class="ttc" id="structmbedtls__ssl__session_html_a2133d1643e524378f074bd9da89aca42"><div class="ttname"><a href="structmbedtls__ssl__session.html#a2133d1643e524378f074bd9da89aca42">mbedtls_ssl_session::peer_cert</a></div><div class="ttdeci">mbedtls_x509_crt * peer_cert</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00556">ssl.h:556</a></div></div>
<div class="ttc" id="structmbedtls__ssl__session_html_ae8adb932e053a2179530a8aff8750624"><div class="ttname"><a href="structmbedtls__ssl__session.html#ae8adb932e053a2179530a8aff8750624">mbedtls_ssl_session::master</a></div><div class="ttdeci">unsigned char master[48]</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00553">ssl.h:553</a></div></div>
<div class="ttc" id="structmbedtls__asn1__buf_html_a0af0cf9b0801a21ce4652e859876f195"><div class="ttname"><a href="structmbedtls__asn1__buf.html#a0af0cf9b0801a21ce4652e859876f195">mbedtls_asn1_buf::p</a></div><div class="ttdeci">unsigned char * p</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00122">asn1.h:122</a></div></div>
<div class="ttc" id="structmbedtls__ssl__cache__entry_html_aaa3550f088fef5e3e2ea793076d77a86"><div class="ttname"><a href="structmbedtls__ssl__cache__entry.html#aaa3550f088fef5e3e2ea793076d77a86">mbedtls_ssl_cache_entry::peer_cert</a></div><div class="ttdeci">mbedtls_x509_buf peer_cert</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00067">ssl_cache.h:67</a></div></div>
<div class="ttc" id="structmbedtls__ssl__session_html_a71b31d138a01adef0ef99f03084da801"><div class="ttname"><a href="structmbedtls__ssl__session.html#a71b31d138a01adef0ef99f03084da801">mbedtls_ssl_session::compression</a></div><div class="ttdeci">int compression</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00550">ssl.h:550</a></div></div>
<div class="ttc" id="ssl__cache_8h_html_a02b027cfb82a0436a19bfeada16cb8db"><div class="ttname"><a href="ssl__cache_8h.html#a02b027cfb82a0436a19bfeada16cb8db">MBEDTLS_SSL_CACHE_DEFAULT_TIMEOUT</a></div><div class="ttdeci">#define MBEDTLS_SSL_CACHE_DEFAULT_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00041">ssl_cache.h:41</a></div></div>
<div class="ttc" id="ssl__cache_8h_html"><div class="ttname"><a href="ssl__cache_8h.html">ssl_cache.h</a></div><div class="ttdoc">SSL session cache implementation. </div></div>
<div class="ttc" id="ssl__cache_8h_html_a03256bf3d0f0c370d6984b441b86567e"><div class="ttname"><a href="ssl__cache_8h.html#a03256bf3d0f0c370d6984b441b86567e">MBEDTLS_SSL_CACHE_DEFAULT_MAX_ENTRIES</a></div><div class="ttdeci">#define MBEDTLS_SSL_CACHE_DEFAULT_MAX_ENTRIES</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00045">ssl_cache.h:45</a></div></div>
<div class="ttc" id="platform_8h_html"><div class="ttname"><a href="platform_8h.html">platform.h</a></div><div class="ttdoc">mbed TLS Platform abstraction layer </div></div>
<div class="ttc" id="structmbedtls__ssl__session_html"><div class="ttname"><a href="structmbedtls__ssl__session.html">mbedtls_ssl_session</a></div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00544">ssl.h:544</a></div></div>
<div class="ttc" id="ssl__cache_8h_html_aa3468c4ebd9484227436014db30b8f5f"><div class="ttname"><a href="ssl__cache_8h.html#aa3468c4ebd9484227436014db30b8f5f">mbedtls_ssl_cache_set_timeout</a></div><div class="ttdeci">void mbedtls_ssl_cache_set_timeout(mbedtls_ssl_cache_context *cache, int timeout)</div><div class="ttdoc">Set the cache timeout (Default: MBEDTLS_SSL_CACHE_DEFAULT_TIMEOUT (1 day)) </div></div>
<div class="ttc" id="structmbedtls__ssl__cache__context_html_a2039e68fc448803446e536e379638acb"><div class="ttname"><a href="structmbedtls__ssl__cache__context.html#a2039e68fc448803446e536e379638acb">mbedtls_ssl_cache_context::chain</a></div><div class="ttdeci">mbedtls_ssl_cache_entry * chain</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00077">ssl_cache.h:77</a></div></div>
<div class="ttc" id="group__x509__module_html_ga033567483649030f7f859db4f4cb7e14"><div class="ttname"><a href="group__x509__module.html#ga033567483649030f7f859db4f4cb7e14">mbedtls_x509_crt_parse</a></div><div class="ttdeci">int mbedtls_x509_crt_parse(mbedtls_x509_crt *chain, const unsigned char *buf, size_t buflen)</div><div class="ttdoc">Parse one or more certificates and add them to the chained list. Parses permissively. If some certificates can be parsed, the result is the number of failed certificates it encountered. If none complete correctly, the first error is returned. </div></div>
<div class="ttc" id="ssl_8h_html_ac085defe1a02ab784a0a2fb201bcc741"><div class="ttname"><a href="ssl_8h.html#ac085defe1a02ab784a0a2fb201bcc741">mbedtls_ssl_session_free</a></div><div class="ttdeci">void mbedtls_ssl_session_free(mbedtls_ssl_session *session)</div><div class="ttdoc">Free referenced items in an SSL session including the peer certificate and clear memory. </div></div>
<div class="ttc" id="structmbedtls__asn1__buf_html"><div class="ttname"><a href="structmbedtls__asn1__buf.html">mbedtls_asn1_buf</a></div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00118">asn1.h:118</a></div></div>
<div class="ttc" id="ssl__cache_8h_html_abc39c23cf3f791359104d9094bd9cf6f"><div class="ttname"><a href="ssl__cache_8h.html#abc39c23cf3f791359104d9094bd9cf6f">mbedtls_ssl_cache_set_max_entries</a></div><div class="ttdeci">void mbedtls_ssl_cache_set_max_entries(mbedtls_ssl_cache_context *cache, int max)</div><div class="ttdoc">Set the maximum number of cache entries (Default: MBEDTLS_SSL_CACHE_DEFAULT_MAX_ENTRIES (50)) ...</div></div>
<div class="ttc" id="ssl__cache_8h_html_a90886fd9ad56471c5ebaed2e05086cd5"><div class="ttname"><a href="ssl__cache_8h.html#a90886fd9ad56471c5ebaed2e05086cd5">mbedtls_ssl_cache_init</a></div><div class="ttdeci">void mbedtls_ssl_cache_init(mbedtls_ssl_cache_context *cache)</div><div class="ttdoc">Initialize an SSL cache context. </div></div>
<div class="ttc" id="structmbedtls__x509__crt_html_a5bfef6b8b81bc081f796cb1f6bb28839"><div class="ttname"><a href="structmbedtls__x509__crt.html#a5bfef6b8b81bc081f796cb1f6bb28839">mbedtls_x509_crt::raw</a></div><div class="ttdeci">mbedtls_x509_buf raw</div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00054">x509_crt.h:54</a></div></div>
<div class="ttc" id="ssl__cache_8h_html_af0ab0006ecbbec9405be5566ac16c4b3"><div class="ttname"><a href="ssl__cache_8h.html#af0ab0006ecbbec9405be5566ac16c4b3">mbedtls_ssl_cache_get</a></div><div class="ttdeci">int mbedtls_ssl_cache_get(void *data, mbedtls_ssl_session *session)</div><div class="ttdoc">Cache get callback implementation (Thread-safe if MBEDTLS_THREADING_C is enabled) ...</div></div>
<div class="ttc" id="structmbedtls__ssl__session_html_ad1bc5443b7ac77eadd1df71a69f18ba6"><div class="ttname"><a href="structmbedtls__ssl__session.html#ad1bc5443b7ac77eadd1df71a69f18ba6">mbedtls_ssl_session::id_len</a></div><div class="ttdeci">size_t id_len</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00551">ssl.h:551</a></div></div>
<div class="ttc" id="structmbedtls__ssl__cache__entry_html_a19cb2ae2020c7bf77ad5cc949d0c8967"><div class="ttname"><a href="structmbedtls__ssl__cache__entry.html#a19cb2ae2020c7bf77ad5cc949d0c8967">mbedtls_ssl_cache_entry::timestamp</a></div><div class="ttdeci">mbedtls_time_t timestamp</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00063">ssl_cache.h:63</a></div></div>
<div class="ttc" id="ssl__cache_8h_html_a896a81cf3107ba7464e6273970c2c1eb"><div class="ttname"><a href="ssl__cache_8h.html#a896a81cf3107ba7464e6273970c2c1eb">mbedtls_ssl_cache_set</a></div><div class="ttdeci">int mbedtls_ssl_cache_set(void *data, const mbedtls_ssl_session *session)</div><div class="ttdoc">Cache set callback implementation (Thread-safe if MBEDTLS_THREADING_C is enabled) ...</div></div>
<div class="ttc" id="ssl__cache_8h_html_a93a35f5cd109f9d698bfac659905c0d8"><div class="ttname"><a href="ssl__cache_8h.html#a93a35f5cd109f9d698bfac659905c0d8">mbedtls_ssl_cache_free</a></div><div class="ttdeci">void mbedtls_ssl_cache_free(mbedtls_ssl_cache_context *cache)</div><div class="ttdoc">Free referenced items in a cache context and clear memory. </div></div>
<div class="ttc" id="structmbedtls__ssl__cache__entry_html"><div class="ttname"><a href="structmbedtls__ssl__cache__entry.html">mbedtls_ssl_cache_entry</a></div><div class="ttdoc">This structure is used for storing cache entries. </div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00060">ssl_cache.h:60</a></div></div>
<div class="ttc" id="structmbedtls__ssl__cache__context_html_a5a490fa803aa85541cab7808db43c477"><div class="ttname"><a href="structmbedtls__ssl__cache__context.html#a5a490fa803aa85541cab7808db43c477">mbedtls_ssl_cache_context::max_entries</a></div><div class="ttdeci">int max_entries</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00079">ssl_cache.h:79</a></div></div>
<div class="ttc" id="structmbedtls__ssl__cache__context_html"><div class="ttname"><a href="structmbedtls__ssl__cache__context.html">mbedtls_ssl_cache_context</a></div><div class="ttdoc">Cache context. </div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00075">ssl_cache.h:75</a></div></div>
<div class="ttc" id="structmbedtls__asn1__buf_html_a046821787f2c5ecbf2df9f15e0d9486c"><div class="ttname"><a href="structmbedtls__asn1__buf.html#a046821787f2c5ecbf2df9f15e0d9486c">mbedtls_asn1_buf::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00121">asn1.h:121</a></div></div>
<div class="ttc" id="structmbedtls__ssl__cache__context_html_af5d2f556c477eb510117b4a34c02dba4"><div class="ttname"><a href="structmbedtls__ssl__cache__context.html#af5d2f556c477eb510117b4a34c02dba4">mbedtls_ssl_cache_context::timeout</a></div><div class="ttdeci">int timeout</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00078">ssl_cache.h:78</a></div></div>
<div class="ttc" id="structmbedtls__x509__crt_html"><div class="ttname"><a href="structmbedtls__x509__crt.html">mbedtls_x509_crt</a></div><div class="ttdef"><b>Definition:</b> <a href="x509__crt_8h_source.html#l00052">x509_crt.h:52</a></div></div>
<div class="ttc" id="group__x509__module_html_ga016dd06bc770e77b84005f305df20ed1"><div class="ttname"><a href="group__x509__module.html#ga016dd06bc770e77b84005f305df20ed1">mbedtls_x509_crt_init</a></div><div class="ttdeci">void mbedtls_x509_crt_init(mbedtls_x509_crt *crt)</div><div class="ttdoc">Initialize a certificate (chain) </div></div>
<div class="ttc" id="structmbedtls__ssl__session_html_abd00d63c5fe4ae5dd87cbba60155fbc4"><div class="ttname"><a href="structmbedtls__ssl__session.html#abd00d63c5fe4ae5dd87cbba60155fbc4">mbedtls_ssl_session::id</a></div><div class="ttdeci">unsigned char id[32]</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00552">ssl.h:552</a></div></div>
<div class="ttc" id="structmbedtls__ssl__session_html_a7767cf999b47eaa545fb6a86b3447a20"><div class="ttname"><a href="structmbedtls__ssl__session.html#a7767cf999b47eaa545fb6a86b3447a20">mbedtls_ssl_session::verify_result</a></div><div class="ttdeci">uint32_t verify_result</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00558">ssl.h:558</a></div></div>
<div class="ttc" id="structmbedtls__ssl__cache__entry_html_a83fee0c73af53bc816d6a5f2ac795481"><div class="ttname"><a href="structmbedtls__ssl__cache__entry.html#a83fee0c73af53bc816d6a5f2ac795481">mbedtls_ssl_cache_entry::next</a></div><div class="ttdeci">mbedtls_ssl_cache_entry * next</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00069">ssl_cache.h:69</a></div></div>
<div class="ttc" id="structmbedtls__ssl__cache__entry_html_ade27f016c0924422c5ba5e68650744bc"><div class="ttname"><a href="structmbedtls__ssl__cache__entry.html#ade27f016c0924422c5ba5e68650744bc">mbedtls_ssl_cache_entry::session</a></div><div class="ttdeci">mbedtls_ssl_session session</div><div class="ttdef"><b>Definition:</b> <a href="ssl__cache_8h_source.html#l00065">ssl_cache.h:65</a></div></div>
<div class="ttc" id="structmbedtls__ssl__session_html_ad91239f4186bd272e3eb441c9c309b9e"><div class="ttname"><a href="structmbedtls__ssl__session.html#ad91239f4186bd272e3eb441c9c309b9e">mbedtls_ssl_session::ciphersuite</a></div><div class="ttdeci">int ciphersuite</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00549">ssl.h:549</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
